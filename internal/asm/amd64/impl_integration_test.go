// Test cases in this file is migrated from the integration test with golang-asm,
// and semi-auto generated through hex encoded string comparison.
// TODO: refactor the cases so as not to use the embedded hex, and put the comments
// about the reasoning on the expected bytes.
package amd64

import (
	"encoding/hex"
	"errors"

	"math"
	"testing"

	"github.com/tetratelabs/wazero/internal/asm"
	"github.com/tetratelabs/wazero/internal/testing/require"
)

// TestAssemblerImpl_Assemble is migrated from the integration test with golang-asm.
func TestAssemblerImpl_Assemble(t *testing.T) {
	t.Run("callback", func(t *testing.T) {
		t.Run("ok", func(t *testing.T) {
			a := NewAssemblerImpl()
			callbacked := false
			a.AddOnGenerateCallBack(func(b []byte) error { callbacked = true; return nil })
			_, err := a.Assemble()
			require.NoError(t, err)
			require.True(t, callbacked)
		})
		t.Run("error", func(t *testing.T) {
			a := NewAssemblerImpl()
			a.AddOnGenerateCallBack(func(b []byte) error { return errors.New("some error") })
			_, err := a.Assemble()
			require.EqualError(t, err, "some error")
		})
	})
	t.Run("no reassemble", func(t *testing.T) {
		a := NewAssemblerImpl()
		jmp := a.CompileJump(JCC)
		const dummyInstruction = CDQ
		a.CompileStandAlone(dummyInstruction)
		a.CompileStandAlone(dummyInstruction)
		a.CompileStandAlone(dummyInstruction)
		jmp.AssignJumpTarget(a.CompileStandAlone(dummyInstruction))

		actual, err := a.Assemble()
		require.NoError(t, err)
		require.Equal(t, "730399999999", hex.EncodeToString(actual))
	})
	t.Run("re-assemble", func(t *testing.T) {
		a := NewAssemblerImpl()
		jmp := a.CompileJump(JCC)
		const dummyInstruction = CDQ
		// Ensure that at least 128 bytes between JCC and the target which results in
		// reassemble as we have to convert the forward jump as long variant.
		for i := 0; i < 128; i++ {
			a.CompileStandAlone(dummyInstruction)
		}
		jmp.AssignJumpTarget(a.CompileStandAlone(dummyInstruction))

		a.InitializeNodesForEncoding()

		// For the first encoding, we must be forced to reassemble.
		err := a.Encode()
		require.NoError(t, err)
		require.True(t, a.ForceReAssemble)
	})
}

func TestAssemblerImpl_Assemble_NOPPadding(t *testing.T) {
	t.Run("non relative jumps", func(t *testing.T) {
		tests := []struct {
			name    string
			setupFn func(assembler Assembler)
			expHex  string
		}{
			{
				name: "RET",
				setupFn: func(assembler Assembler) {
					for i := 0; i < 128; i++ {
						assembler.CompileStandAlone(RET)
					}
				},
				expHex: `c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c390c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c390c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c390c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c390c3c3c3c3`,
			},
			{
				name: "JMP to register",
				setupFn: func(assembler Assembler) {
					for i := 0; i < 128; i++ {
						assembler.CompileJumpToRegister(JMP, RegAX)
					}
				},
				expHex: `ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe06690ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe06690ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe06690ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe06690ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe06690ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe06690ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe06690ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe06690ffe0ffe0ffe0ffe0ffe0ffe0ffe0ffe0`,
			},
			{
				name: "JMP to memory",
				setupFn: func(assembler Assembler) {
					for i := 0; i < 128; i++ {
						assembler.CompileJumpToMemory(JMP, RegAX, 10)
					}
				},
				expHex: `ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600aff600aff600a6690ff600aff600aff600aff600aff600aff600aff600aff600a`,
			},
			{
				name: "JMP to memory large offset",
				setupFn: func(assembler Assembler) {
					for i := 0; i < 128; i++ {
						assembler.CompileJumpToMemory(JMP, RegAX, math.MaxInt32)
					}
				},
				expHex: `ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7fffa0ffffff7f6690ffa0ffffff7fffa0ffffff7fffa0ffffff7f`,
			},
		}

		for _, tt := range tests {
			tc := tt
			t.Run(tc.name, func(t *testing.T) {
				a := NewAssemblerImpl()
				tc.setupFn(a)

				actual, err := a.Assemble()
				require.NoError(t, err)

				require.Equal(t, tc.expHex, hex.EncodeToString(actual))
			})
		}
	})
	t.Run("relative jumps", func(t *testing.T) {

		cases := []struct {
			name        string
			instruction asm.Instruction
			backward    bool
			expectedHex string
		}{
			{
				name:        "JMP",
				instruction: JMP,
				backward:    false,
				expectedHex: "c3e9e4010000e9df010000e9da010000e9d5010000e9d0010000e9cb01000090e9c5010000e9c0010000e9bb010000e9b6010000e9b1010000e9ac0100006690e9a5010000e9a0010000e99b010000e996010000e991010000e98c0100006690e985010000e980010000e97b010000e976010000e971010000e96c0100006690e965010000e960010000e95b010000e956010000e951010000e94c0100006690e945010000e940010000e93b010000e936010000e931010000e92c0100006690e925010000e920010000e91b010000e916010000e911010000e90c0100006690e905010000e900010000e9fb000000e9f6000000e9f1000000e9ec0000006690e9e5000000e9e0000000e9db000000e9d6000000e9d1000000e9cc0000006690e9c5000000e9c0000000e9bb000000e9b6000000e9b1000000e9ac0000006690e9a5000000e9a0000000e99b000000e996000000e991000000e98c0000006690e985000000e980000000eb7eeb7ceb7aeb78eb76eb74eb72eb70eb6eeb6c6690eb68eb66eb64eb62eb60eb5eeb5ceb5aeb58eb56eb54eb52eb50eb4eeb4c6690eb48eb46eb44eb42eb40eb3eeb3ceb3aeb38eb36eb34eb32eb30eb2eeb2c6690eb28eb26eb24eb22eb20eb1eeb1ceb1aeb18eb16eb14eb12eb10eb0eeb0c6690eb08eb06eb04eb02eb00c3",
			},
			{
				name:        "JCC",
				instruction: JCC,
				backward:    false,
				expectedHex: "c30f832b0200000f83250200000f831f0200000f83190200000f8313020000900f830c0200000f83060200000f83000200000f83fa0100000f83f401000066900f83ec0100000f83e60100000f83e00100000f83da0100000f83d401000066900f83cc0100000f83c60100000f83c00100000f83ba0100000f83b401000066900f83ac0100000f83a60100000f83a00100000f839a0100000f839401000066900f838c0100000f83860100000f83800100000f837a0100000f837401000066900f836c0100000f83660100000f83600100000f835a0100000f835401000066900f834c0100000f83460100000f83400100000f833a0100000f833401000066900f832c0100000f83260100000f83200100000f831a0100000f831401000066900f830c0100000f83060100000f83000100000f83fa0000000f83f400000066900f83ec0000000f83e60000000f83e00000000f83da0000000f83d400000066900f83cc0000000f83c60000000f83c00000000f83ba0000000f83b400000066900f83ac0000000f83a60000000f83a00000000f839a0000000f839400000066900f838c0000000f83860000000f8380000000737e737c737a73787376737466907370736e736c736a73687366736473627360735e735c735a73587356735466907350734e734c734a73487346734473427340733e733c733a73387336733466907330732e732c732a73287326732473227320731e731c731a73187316731466907310730e730c730a73087306730473027300c3",
			},
			{
				name:        "JCS",
				instruction: JCS,
				backward:    false,
				expectedHex: "c30f822b0200000f82250200000f821f0200000f82190200000f8213020000900f820c0200000f82060200000f82000200000f82fa0100000f82f401000066900f82ec0100000f82e60100000f82e00100000f82da0100000f82d401000066900f82cc0100000f82c60100000f82c00100000f82ba0100000f82b401000066900f82ac0100000f82a60100000f82a00100000f829a0100000f829401000066900f828c0100000f82860100000f82800100000f827a0100000f827401000066900f826c0100000f82660100000f82600100000f825a0100000f825401000066900f824c0100000f82460100000f82400100000f823a0100000f823401000066900f822c0100000f82260100000f82200100000f821a0100000f821401000066900f820c0100000f82060100000f82000100000f82fa0000000f82f400000066900f82ec0000000f82e60000000f82e00000000f82da0000000f82d400000066900f82cc0000000f82c60000000f82c00000000f82ba0000000f82b400000066900f82ac0000000f82a60000000f82a00000000f829a0000000f829400000066900f828c0000000f82860000000f8280000000727e727c727a72787276727466907270726e726c726a72687266726472627260725e725c725a72587256725466907250724e724c724a72487246724472427240723e723c723a72387236723466907230722e722c722a72287226722472227220721e721c721a72187216721466907210720e720c720a72087206720472027200c3",
			},
			{
				name:        "JEQ",
				instruction: JEQ,
				backward:    false,
				expectedHex: "c30f842b0200000f84250200000f841f0200000f84190200000f8413020000900f840c0200000f84060200000f84000200000f84fa0100000f84f401000066900f84ec0100000f84e60100000f84e00100000f84da0100000f84d401000066900f84cc0100000f84c60100000f84c00100000f84ba0100000f84b401000066900f84ac0100000f84a60100000f84a00100000f849a0100000f849401000066900f848c0100000f84860100000f84800100000f847a0100000f847401000066900f846c0100000f84660100000f84600100000f845a0100000f845401000066900f844c0100000f84460100000f84400100000f843a0100000f843401000066900f842c0100000f84260100000f84200100000f841a0100000f841401000066900f840c0100000f84060100000f84000100000f84fa0000000f84f400000066900f84ec0000000f84e60000000f84e00000000f84da0000000f84d400000066900f84cc0000000f84c60000000f84c00000000f84ba0000000f84b400000066900f84ac0000000f84a60000000f84a00000000f849a0000000f849400000066900f848c0000000f84860000000f8480000000747e747c747a74787476747466907470746e746c746a74687466746474627460745e745c745a74587456745466907450744e744c744a74487446744474427440743e743c743a74387436743466907430742e742c742a74287426742474227420741e741c741a74187416741466907410740e740c740a74087406740474027400c3",
			},
			{
				name:        "JGE",
				instruction: JGE,
				backward:    false,
				expectedHex: "c30f8d2b0200000f8d250200000f8d1f0200000f8d190200000f8d13020000900f8d0c0200000f8d060200000f8d000200000f8dfa0100000f8df401000066900f8dec0100000f8de60100000f8de00100000f8dda0100000f8dd401000066900f8dcc0100000f8dc60100000f8dc00100000f8dba0100000f8db401000066900f8dac0100000f8da60100000f8da00100000f8d9a0100000f8d9401000066900f8d8c0100000f8d860100000f8d800100000f8d7a0100000f8d7401000066900f8d6c0100000f8d660100000f8d600100000f8d5a0100000f8d5401000066900f8d4c0100000f8d460100000f8d400100000f8d3a0100000f8d3401000066900f8d2c0100000f8d260100000f8d200100000f8d1a0100000f8d1401000066900f8d0c0100000f8d060100000f8d000100000f8dfa0000000f8df400000066900f8dec0000000f8de60000000f8de00000000f8dda0000000f8dd400000066900f8dcc0000000f8dc60000000f8dc00000000f8dba0000000f8db400000066900f8dac0000000f8da60000000f8da00000000f8d9a0000000f8d9400000066900f8d8c0000000f8d860000000f8d800000007d7e7d7c7d7a7d787d767d7466907d707d6e7d6c7d6a7d687d667d647d627d607d5e7d5c7d5a7d587d567d5466907d507d4e7d4c7d4a7d487d467d447d427d407d3e7d3c7d3a7d387d367d3466907d307d2e7d2c7d2a7d287d267d247d227d207d1e7d1c7d1a7d187d167d1466907d107d0e7d0c7d0a7d087d067d047d027d00c3",
			},
			{
				name:        "JGT",
				instruction: JGT,
				backward:    false,
				expectedHex: "c30f8f2b0200000f8f250200000f8f1f0200000f8f190200000f8f13020000900f8f0c0200000f8f060200000f8f000200000f8ffa0100000f8ff401000066900f8fec0100000f8fe60100000f8fe00100000f8fda0100000f8fd401000066900f8fcc0100000f8fc60100000f8fc00100000f8fba0100000f8fb401000066900f8fac0100000f8fa60100000f8fa00100000f8f9a0100000f8f9401000066900f8f8c0100000f8f860100000f8f800100000f8f7a0100000f8f7401000066900f8f6c0100000f8f660100000f8f600100000f8f5a0100000f8f5401000066900f8f4c0100000f8f460100000f8f400100000f8f3a0100000f8f3401000066900f8f2c0100000f8f260100000f8f200100000f8f1a0100000f8f1401000066900f8f0c0100000f8f060100000f8f000100000f8ffa0000000f8ff400000066900f8fec0000000f8fe60000000f8fe00000000f8fda0000000f8fd400000066900f8fcc0000000f8fc60000000f8fc00000000f8fba0000000f8fb400000066900f8fac0000000f8fa60000000f8fa00000000f8f9a0000000f8f9400000066900f8f8c0000000f8f860000000f8f800000007f7e7f7c7f7a7f787f767f7466907f707f6e7f6c7f6a7f687f667f647f627f607f5e7f5c7f5a7f587f567f5466907f507f4e7f4c7f4a7f487f467f447f427f407f3e7f3c7f3a7f387f367f3466907f307f2e7f2c7f2a7f287f267f247f227f207f1e7f1c7f1a7f187f167f1466907f107f0e7f0c7f0a7f087f067f047f027f00c3",
			},
			{
				name:        "JHI",
				instruction: JHI,
				backward:    false,
				expectedHex: "c30f872b0200000f87250200000f871f0200000f87190200000f8713020000900f870c0200000f87060200000f87000200000f87fa0100000f87f401000066900f87ec0100000f87e60100000f87e00100000f87da0100000f87d401000066900f87cc0100000f87c60100000f87c00100000f87ba0100000f87b401000066900f87ac0100000f87a60100000f87a00100000f879a0100000f879401000066900f878c0100000f87860100000f87800100000f877a0100000f877401000066900f876c0100000f87660100000f87600100000f875a0100000f875401000066900f874c0100000f87460100000f87400100000f873a0100000f873401000066900f872c0100000f87260100000f87200100000f871a0100000f871401000066900f870c0100000f87060100000f87000100000f87fa0000000f87f400000066900f87ec0000000f87e60000000f87e00000000f87da0000000f87d400000066900f87cc0000000f87c60000000f87c00000000f87ba0000000f87b400000066900f87ac0000000f87a60000000f87a00000000f879a0000000f879400000066900f878c0000000f87860000000f8780000000777e777c777a77787776777466907770776e776c776a77687766776477627760775e775c775a77587756775466907750774e774c774a77487746774477427740773e773c773a77387736773466907730772e772c772a77287726772477227720771e771c771a77187716771466907710770e770c770a77087706770477027700c3",
			},
			{
				name:        "JLE",
				instruction: JLE,
				backward:    false,
				expectedHex: "c30f8e2b0200000f8e250200000f8e1f0200000f8e190200000f8e13020000900f8e0c0200000f8e060200000f8e000200000f8efa0100000f8ef401000066900f8eec0100000f8ee60100000f8ee00100000f8eda0100000f8ed401000066900f8ecc0100000f8ec60100000f8ec00100000f8eba0100000f8eb401000066900f8eac0100000f8ea60100000f8ea00100000f8e9a0100000f8e9401000066900f8e8c0100000f8e860100000f8e800100000f8e7a0100000f8e7401000066900f8e6c0100000f8e660100000f8e600100000f8e5a0100000f8e5401000066900f8e4c0100000f8e460100000f8e400100000f8e3a0100000f8e3401000066900f8e2c0100000f8e260100000f8e200100000f8e1a0100000f8e1401000066900f8e0c0100000f8e060100000f8e000100000f8efa0000000f8ef400000066900f8eec0000000f8ee60000000f8ee00000000f8eda0000000f8ed400000066900f8ecc0000000f8ec60000000f8ec00000000f8eba0000000f8eb400000066900f8eac0000000f8ea60000000f8ea00000000f8e9a0000000f8e9400000066900f8e8c0000000f8e860000000f8e800000007e7e7e7c7e7a7e787e767e7466907e707e6e7e6c7e6a7e687e667e647e627e607e5e7e5c7e5a7e587e567e5466907e507e4e7e4c7e4a7e487e467e447e427e407e3e7e3c7e3a7e387e367e3466907e307e2e7e2c7e2a7e287e267e247e227e207e1e7e1c7e1a7e187e167e1466907e107e0e7e0c7e0a7e087e067e047e027e00c3",
			},
			{
				name:        "JLS",
				instruction: JLS,
				backward:    false,
				expectedHex: "c30f862b0200000f86250200000f861f0200000f86190200000f8613020000900f860c0200000f86060200000f86000200000f86fa0100000f86f401000066900f86ec0100000f86e60100000f86e00100000f86da0100000f86d401000066900f86cc0100000f86c60100000f86c00100000f86ba0100000f86b401000066900f86ac0100000f86a60100000f86a00100000f869a0100000f869401000066900f868c0100000f86860100000f86800100000f867a0100000f867401000066900f866c0100000f86660100000f86600100000f865a0100000f865401000066900f864c0100000f86460100000f86400100000f863a0100000f863401000066900f862c0100000f86260100000f86200100000f861a0100000f861401000066900f860c0100000f86060100000f86000100000f86fa0000000f86f400000066900f86ec0000000f86e60000000f86e00000000f86da0000000f86d400000066900f86cc0000000f86c60000000f86c00000000f86ba0000000f86b400000066900f86ac0000000f86a60000000f86a00000000f869a0000000f869400000066900f868c0000000f86860000000f8680000000767e767c767a76787676767466907670766e766c766a76687666766476627660765e765c765a76587656765466907650764e764c764a76487646764476427640763e763c763a76387636763466907630762e762c762a76287626762476227620761e761c761a76187616761466907610760e760c760a76087606760476027600c3",
			},
			{
				name:        "JLT",
				instruction: JLT,
				backward:    false,
				expectedHex: "c30f8c2b0200000f8c250200000f8c1f0200000f8c190200000f8c13020000900f8c0c0200000f8c060200000f8c000200000f8cfa0100000f8cf401000066900f8cec0100000f8ce60100000f8ce00100000f8cda0100000f8cd401000066900f8ccc0100000f8cc60100000f8cc00100000f8cba0100000f8cb401000066900f8cac0100000f8ca60100000f8ca00100000f8c9a0100000f8c9401000066900f8c8c0100000f8c860100000f8c800100000f8c7a0100000f8c7401000066900f8c6c0100000f8c660100000f8c600100000f8c5a0100000f8c5401000066900f8c4c0100000f8c460100000f8c400100000f8c3a0100000f8c3401000066900f8c2c0100000f8c260100000f8c200100000f8c1a0100000f8c1401000066900f8c0c0100000f8c060100000f8c000100000f8cfa0000000f8cf400000066900f8cec0000000f8ce60000000f8ce00000000f8cda0000000f8cd400000066900f8ccc0000000f8cc60000000f8cc00000000f8cba0000000f8cb400000066900f8cac0000000f8ca60000000f8ca00000000f8c9a0000000f8c9400000066900f8c8c0000000f8c860000000f8c800000007c7e7c7c7c7a7c787c767c7466907c707c6e7c6c7c6a7c687c667c647c627c607c5e7c5c7c5a7c587c567c5466907c507c4e7c4c7c4a7c487c467c447c427c407c3e7c3c7c3a7c387c367c3466907c307c2e7c2c7c2a7c287c267c247c227c207c1e7c1c7c1a7c187c167c1466907c107c0e7c0c7c0a7c087c067c047c027c00c3",
			},
			{
				name:        "JMI",
				instruction: JMI,
				backward:    false,
				expectedHex: "c30f882b0200000f88250200000f881f0200000f88190200000f8813020000900f880c0200000f88060200000f88000200000f88fa0100000f88f401000066900f88ec0100000f88e60100000f88e00100000f88da0100000f88d401000066900f88cc0100000f88c60100000f88c00100000f88ba0100000f88b401000066900f88ac0100000f88a60100000f88a00100000f889a0100000f889401000066900f888c0100000f88860100000f88800100000f887a0100000f887401000066900f886c0100000f88660100000f88600100000f885a0100000f885401000066900f884c0100000f88460100000f88400100000f883a0100000f883401000066900f882c0100000f88260100000f88200100000f881a0100000f881401000066900f880c0100000f88060100000f88000100000f88fa0000000f88f400000066900f88ec0000000f88e60000000f88e00000000f88da0000000f88d400000066900f88cc0000000f88c60000000f88c00000000f88ba0000000f88b400000066900f88ac0000000f88a60000000f88a00000000f889a0000000f889400000066900f888c0000000f88860000000f8880000000787e787c787a78787876787466907870786e786c786a78687866786478627860785e785c785a78587856785466907850784e784c784a78487846784478427840783e783c783a78387836783466907830782e782c782a78287826782478227820781e781c781a78187816781466907810780e780c780a78087806780478027800c3",
			},
			{
				name:        "JNE",
				instruction: JNE,
				backward:    false,
				expectedHex: "c30f852b0200000f85250200000f851f0200000f85190200000f8513020000900f850c0200000f85060200000f85000200000f85fa0100000f85f401000066900f85ec0100000f85e60100000f85e00100000f85da0100000f85d401000066900f85cc0100000f85c60100000f85c00100000f85ba0100000f85b401000066900f85ac0100000f85a60100000f85a00100000f859a0100000f859401000066900f858c0100000f85860100000f85800100000f857a0100000f857401000066900f856c0100000f85660100000f85600100000f855a0100000f855401000066900f854c0100000f85460100000f85400100000f853a0100000f853401000066900f852c0100000f85260100000f85200100000f851a0100000f851401000066900f850c0100000f85060100000f85000100000f85fa0000000f85f400000066900f85ec0000000f85e60000000f85e00000000f85da0000000f85d400000066900f85cc0000000f85c60000000f85c00000000f85ba0000000f85b400000066900f85ac0000000f85a60000000f85a00000000f859a0000000f859400000066900f858c0000000f85860000000f8580000000757e757c757a75787576757466907570756e756c756a75687566756475627560755e755c755a75587556755466907550754e754c754a75487546754475427540753e753c753a75387536753466907530752e752c752a75287526752475227520751e751c751a75187516751466907510750e750c750a75087506750475027500c3",
			},
			{
				name:        "JPC",
				instruction: JPC,
				backward:    false,
				expectedHex: "c30f8b2b0200000f8b250200000f8b1f0200000f8b190200000f8b13020000900f8b0c0200000f8b060200000f8b000200000f8bfa0100000f8bf401000066900f8bec0100000f8be60100000f8be00100000f8bda0100000f8bd401000066900f8bcc0100000f8bc60100000f8bc00100000f8bba0100000f8bb401000066900f8bac0100000f8ba60100000f8ba00100000f8b9a0100000f8b9401000066900f8b8c0100000f8b860100000f8b800100000f8b7a0100000f8b7401000066900f8b6c0100000f8b660100000f8b600100000f8b5a0100000f8b5401000066900f8b4c0100000f8b460100000f8b400100000f8b3a0100000f8b3401000066900f8b2c0100000f8b260100000f8b200100000f8b1a0100000f8b1401000066900f8b0c0100000f8b060100000f8b000100000f8bfa0000000f8bf400000066900f8bec0000000f8be60000000f8be00000000f8bda0000000f8bd400000066900f8bcc0000000f8bc60000000f8bc00000000f8bba0000000f8bb400000066900f8bac0000000f8ba60000000f8ba00000000f8b9a0000000f8b9400000066900f8b8c0000000f8b860000000f8b800000007b7e7b7c7b7a7b787b767b7466907b707b6e7b6c7b6a7b687b667b647b627b607b5e7b5c7b5a7b587b567b5466907b507b4e7b4c7b4a7b487b467b447b427b407b3e7b3c7b3a7b387b367b3466907b307b2e7b2c7b2a7b287b267b247b227b207b1e7b1c7b1a7b187b167b1466907b107b0e7b0c7b0a7b087b067b047b027b00c3",
			},
			{
				name:        "JPS",
				instruction: JPS,
				backward:    false,
				expectedHex: "c30f8a2b0200000f8a250200000f8a1f0200000f8a190200000f8a13020000900f8a0c0200000f8a060200000f8a000200000f8afa0100000f8af401000066900f8aec0100000f8ae60100000f8ae00100000f8ada0100000f8ad401000066900f8acc0100000f8ac60100000f8ac00100000f8aba0100000f8ab401000066900f8aac0100000f8aa60100000f8aa00100000f8a9a0100000f8a9401000066900f8a8c0100000f8a860100000f8a800100000f8a7a0100000f8a7401000066900f8a6c0100000f8a660100000f8a600100000f8a5a0100000f8a5401000066900f8a4c0100000f8a460100000f8a400100000f8a3a0100000f8a3401000066900f8a2c0100000f8a260100000f8a200100000f8a1a0100000f8a1401000066900f8a0c0100000f8a060100000f8a000100000f8afa0000000f8af400000066900f8aec0000000f8ae60000000f8ae00000000f8ada0000000f8ad400000066900f8acc0000000f8ac60000000f8ac00000000f8aba0000000f8ab400000066900f8aac0000000f8aa60000000f8aa00000000f8a9a0000000f8a9400000066900f8a8c0000000f8a860000000f8a800000007a7e7a7c7a7a7a787a767a7466907a707a6e7a6c7a6a7a687a667a647a627a607a5e7a5c7a5a7a587a567a5466907a507a4e7a4c7a4a7a487a467a447a427a407a3e7a3c7a3a7a387a367a3466907a307a2e7a2c7a2a7a287a267a247a227a207a1e7a1c7a1a7a187a167a1466907a107a0e7a0c7a0a7a087a067a047a027a00c3",
			},
			{
				name:        "JMP",
				instruction: JMP,
				backward:    true,
				expectedHex: "c3ebfdebfbebf9ebf7ebf5ebf3ebf1ebefebedebebebe9ebe7ebe5ebe3ebe190ebdeebdcebdaebd8ebd6ebd4ebd2ebd0ebceebccebcaebc8ebc6ebc4ebc26690ebbeebbcebbaebb8ebb6ebb4ebb2ebb0ebaeebacebaaeba8eba6eba4eba26690eb9eeb9ceb9aeb98eb96eb94eb92eb90eb8eeb8ceb8aeb88eb86eb84eb826690e97bffffffe976ffffffe971ffffffe96cffffffe967ffffffe962ffffff6690e95bffffffe956ffffffe951ffffffe94cffffffe947ffffffe942ffffff6690e93bffffffe936ffffffe931ffffffe92cffffffe927ffffffe922ffffff6690e91bffffffe916ffffffe911ffffffe90cffffffe907ffffffe902ffffff6690e9fbfeffffe9f6feffffe9f1feffffe9ecfeffffe9e7feffffe9e2feffff6690e9dbfeffffe9d6feffffe9d1feffffe9ccfeffffe9c7feffffe9c2feffff6690e9bbfeffffe9b6feffffe9b1feffffe9acfeffffe9a7feffffe9a2feffff6690e99bfeffffe996feffffe991feffffe98cfeffffe987feffffe982feffff6690e97bfeffffe976feffffe971feffffe96cfeffffe967feffffe962feffff6690e95bfeffffe956feffffe951feffffe94cfeffffe947feffffe942feffff6690e93bfeffffe936feffffe931feffffe92cfeffffe927feffffe922feffff6690e91bfeffffe916feffffc3",
			},
			{
				name:        "JCC",
				instruction: JCC,
				backward:    true,
				expectedHex: "c373fd73fb73f973f773f573f373f173ef73ed73eb73e973e773e573e373e19073de73dc73da73d873d673d473d273d073ce73cc73ca73c873c673c473c2669073be73bc73ba73b873b673b473b273b073ae73ac73aa73a873a673a473a26690739e739c739a73987396739473927390738e738c738a738873867384738266900f837affffff0f8374ffffff0f836effffff0f8368ffffff0f8362ffffff66900f835affffff0f8354ffffff0f834effffff0f8348ffffff0f8342ffffff66900f833affffff0f8334ffffff0f832effffff0f8328ffffff0f8322ffffff66900f831affffff0f8314ffffff0f830effffff0f8308ffffff0f8302ffffff66900f83fafeffff0f83f4feffff0f83eefeffff0f83e8feffff0f83e2feffff66900f83dafeffff0f83d4feffff0f83cefeffff0f83c8feffff0f83c2feffff66900f83bafeffff0f83b4feffff0f83aefeffff0f83a8feffff0f83a2feffff66900f839afeffff0f8394feffff0f838efeffff0f8388feffff0f8382feffff66900f837afeffff0f8374feffff0f836efeffff0f8368feffff0f8362feffff66900f835afeffff0f8354feffff0f834efeffff0f8348feffff0f8342feffff66900f833afeffff0f8334feffff0f832efeffff0f8328feffff0f8322feffff66900f831afeffff0f8314feffff0f830efeffff0f8308feffff0f8302feffff66900f83fafdffff0f83f4fdffff0f83eefdffff0f83e8fdffff0f83e2fdffff66900f83dafdffff0f83d4fdffff0f83cefdffffc3",
			},
			{
				name:        "JCS",
				instruction: JCS,
				backward:    true,
				expectedHex: "c372fd72fb72f972f772f572f372f172ef72ed72eb72e972e772e572e372e19072de72dc72da72d872d672d472d272d072ce72cc72ca72c872c672c472c2669072be72bc72ba72b872b672b472b272b072ae72ac72aa72a872a672a472a26690729e729c729a72987296729472927290728e728c728a728872867284728266900f827affffff0f8274ffffff0f826effffff0f8268ffffff0f8262ffffff66900f825affffff0f8254ffffff0f824effffff0f8248ffffff0f8242ffffff66900f823affffff0f8234ffffff0f822effffff0f8228ffffff0f8222ffffff66900f821affffff0f8214ffffff0f820effffff0f8208ffffff0f8202ffffff66900f82fafeffff0f82f4feffff0f82eefeffff0f82e8feffff0f82e2feffff66900f82dafeffff0f82d4feffff0f82cefeffff0f82c8feffff0f82c2feffff66900f82bafeffff0f82b4feffff0f82aefeffff0f82a8feffff0f82a2feffff66900f829afeffff0f8294feffff0f828efeffff0f8288feffff0f8282feffff66900f827afeffff0f8274feffff0f826efeffff0f8268feffff0f8262feffff66900f825afeffff0f8254feffff0f824efeffff0f8248feffff0f8242feffff66900f823afeffff0f8234feffff0f822efeffff0f8228feffff0f8222feffff66900f821afeffff0f8214feffff0f820efeffff0f8208feffff0f8202feffff66900f82fafdffff0f82f4fdffff0f82eefdffff0f82e8fdffff0f82e2fdffff66900f82dafdffff0f82d4fdffff0f82cefdffffc3",
			},
			{
				name:        "JEQ",
				instruction: JEQ,
				backward:    true,
				expectedHex: "c374fd74fb74f974f774f574f374f174ef74ed74eb74e974e774e574e374e19074de74dc74da74d874d674d474d274d074ce74cc74ca74c874c674c474c2669074be74bc74ba74b874b674b474b274b074ae74ac74aa74a874a674a474a26690749e749c749a74987496749474927490748e748c748a748874867484748266900f847affffff0f8474ffffff0f846effffff0f8468ffffff0f8462ffffff66900f845affffff0f8454ffffff0f844effffff0f8448ffffff0f8442ffffff66900f843affffff0f8434ffffff0f842effffff0f8428ffffff0f8422ffffff66900f841affffff0f8414ffffff0f840effffff0f8408ffffff0f8402ffffff66900f84fafeffff0f84f4feffff0f84eefeffff0f84e8feffff0f84e2feffff66900f84dafeffff0f84d4feffff0f84cefeffff0f84c8feffff0f84c2feffff66900f84bafeffff0f84b4feffff0f84aefeffff0f84a8feffff0f84a2feffff66900f849afeffff0f8494feffff0f848efeffff0f8488feffff0f8482feffff66900f847afeffff0f8474feffff0f846efeffff0f8468feffff0f8462feffff66900f845afeffff0f8454feffff0f844efeffff0f8448feffff0f8442feffff66900f843afeffff0f8434feffff0f842efeffff0f8428feffff0f8422feffff66900f841afeffff0f8414feffff0f840efeffff0f8408feffff0f8402feffff66900f84fafdffff0f84f4fdffff0f84eefdffff0f84e8fdffff0f84e2fdffff66900f84dafdffff0f84d4fdffff0f84cefdffffc3",
			},
			{
				name:        "JGE",
				instruction: JGE,
				backward:    true,
				expectedHex: "c37dfd7dfb7df97df77df57df37df17def7ded7deb7de97de77de57de37de1907dde7ddc7dda7dd87dd67dd47dd27dd07dce7dcc7dca7dc87dc67dc47dc266907dbe7dbc7dba7db87db67db47db27db07dae7dac7daa7da87da67da47da266907d9e7d9c7d9a7d987d967d947d927d907d8e7d8c7d8a7d887d867d847d8266900f8d7affffff0f8d74ffffff0f8d6effffff0f8d68ffffff0f8d62ffffff66900f8d5affffff0f8d54ffffff0f8d4effffff0f8d48ffffff0f8d42ffffff66900f8d3affffff0f8d34ffffff0f8d2effffff0f8d28ffffff0f8d22ffffff66900f8d1affffff0f8d14ffffff0f8d0effffff0f8d08ffffff0f8d02ffffff66900f8dfafeffff0f8df4feffff0f8deefeffff0f8de8feffff0f8de2feffff66900f8ddafeffff0f8dd4feffff0f8dcefeffff0f8dc8feffff0f8dc2feffff66900f8dbafeffff0f8db4feffff0f8daefeffff0f8da8feffff0f8da2feffff66900f8d9afeffff0f8d94feffff0f8d8efeffff0f8d88feffff0f8d82feffff66900f8d7afeffff0f8d74feffff0f8d6efeffff0f8d68feffff0f8d62feffff66900f8d5afeffff0f8d54feffff0f8d4efeffff0f8d48feffff0f8d42feffff66900f8d3afeffff0f8d34feffff0f8d2efeffff0f8d28feffff0f8d22feffff66900f8d1afeffff0f8d14feffff0f8d0efeffff0f8d08feffff0f8d02feffff66900f8dfafdffff0f8df4fdffff0f8deefdffff0f8de8fdffff0f8de2fdffff66900f8ddafdffff0f8dd4fdffff0f8dcefdffffc3",
			},
			{
				name:        "JGT",
				instruction: JGT,
				backward:    true,
				expectedHex: "c37ffd7ffb7ff97ff77ff57ff37ff17fef7fed7feb7fe97fe77fe57fe37fe1907fde7fdc7fda7fd87fd67fd47fd27fd07fce7fcc7fca7fc87fc67fc47fc266907fbe7fbc7fba7fb87fb67fb47fb27fb07fae7fac7faa7fa87fa67fa47fa266907f9e7f9c7f9a7f987f967f947f927f907f8e7f8c7f8a7f887f867f847f8266900f8f7affffff0f8f74ffffff0f8f6effffff0f8f68ffffff0f8f62ffffff66900f8f5affffff0f8f54ffffff0f8f4effffff0f8f48ffffff0f8f42ffffff66900f8f3affffff0f8f34ffffff0f8f2effffff0f8f28ffffff0f8f22ffffff66900f8f1affffff0f8f14ffffff0f8f0effffff0f8f08ffffff0f8f02ffffff66900f8ffafeffff0f8ff4feffff0f8feefeffff0f8fe8feffff0f8fe2feffff66900f8fdafeffff0f8fd4feffff0f8fcefeffff0f8fc8feffff0f8fc2feffff66900f8fbafeffff0f8fb4feffff0f8faefeffff0f8fa8feffff0f8fa2feffff66900f8f9afeffff0f8f94feffff0f8f8efeffff0f8f88feffff0f8f82feffff66900f8f7afeffff0f8f74feffff0f8f6efeffff0f8f68feffff0f8f62feffff66900f8f5afeffff0f8f54feffff0f8f4efeffff0f8f48feffff0f8f42feffff66900f8f3afeffff0f8f34feffff0f8f2efeffff0f8f28feffff0f8f22feffff66900f8f1afeffff0f8f14feffff0f8f0efeffff0f8f08feffff0f8f02feffff66900f8ffafdffff0f8ff4fdffff0f8feefdffff0f8fe8fdffff0f8fe2fdffff66900f8fdafdffff0f8fd4fdffff0f8fcefdffffc3",
			},
			{
				name:        "JHI",
				instruction: JHI,
				backward:    true,
				expectedHex: "c377fd77fb77f977f777f577f377f177ef77ed77eb77e977e777e577e377e19077de77dc77da77d877d677d477d277d077ce77cc77ca77c877c677c477c2669077be77bc77ba77b877b677b477b277b077ae77ac77aa77a877a677a477a26690779e779c779a77987796779477927790778e778c778a778877867784778266900f877affffff0f8774ffffff0f876effffff0f8768ffffff0f8762ffffff66900f875affffff0f8754ffffff0f874effffff0f8748ffffff0f8742ffffff66900f873affffff0f8734ffffff0f872effffff0f8728ffffff0f8722ffffff66900f871affffff0f8714ffffff0f870effffff0f8708ffffff0f8702ffffff66900f87fafeffff0f87f4feffff0f87eefeffff0f87e8feffff0f87e2feffff66900f87dafeffff0f87d4feffff0f87cefeffff0f87c8feffff0f87c2feffff66900f87bafeffff0f87b4feffff0f87aefeffff0f87a8feffff0f87a2feffff66900f879afeffff0f8794feffff0f878efeffff0f8788feffff0f8782feffff66900f877afeffff0f8774feffff0f876efeffff0f8768feffff0f8762feffff66900f875afeffff0f8754feffff0f874efeffff0f8748feffff0f8742feffff66900f873afeffff0f8734feffff0f872efeffff0f8728feffff0f8722feffff66900f871afeffff0f8714feffff0f870efeffff0f8708feffff0f8702feffff66900f87fafdffff0f87f4fdffff0f87eefdffff0f87e8fdffff0f87e2fdffff66900f87dafdffff0f87d4fdffff0f87cefdffffc3",
			},
			{
				name:        "JLE",
				instruction: JLE,
				backward:    true,
				expectedHex: "c37efd7efb7ef97ef77ef57ef37ef17eef7eed7eeb7ee97ee77ee57ee37ee1907ede7edc7eda7ed87ed67ed47ed27ed07ece7ecc7eca7ec87ec67ec47ec266907ebe7ebc7eba7eb87eb67eb47eb27eb07eae7eac7eaa7ea87ea67ea47ea266907e9e7e9c7e9a7e987e967e947e927e907e8e7e8c7e8a7e887e867e847e8266900f8e7affffff0f8e74ffffff0f8e6effffff0f8e68ffffff0f8e62ffffff66900f8e5affffff0f8e54ffffff0f8e4effffff0f8e48ffffff0f8e42ffffff66900f8e3affffff0f8e34ffffff0f8e2effffff0f8e28ffffff0f8e22ffffff66900f8e1affffff0f8e14ffffff0f8e0effffff0f8e08ffffff0f8e02ffffff66900f8efafeffff0f8ef4feffff0f8eeefeffff0f8ee8feffff0f8ee2feffff66900f8edafeffff0f8ed4feffff0f8ecefeffff0f8ec8feffff0f8ec2feffff66900f8ebafeffff0f8eb4feffff0f8eaefeffff0f8ea8feffff0f8ea2feffff66900f8e9afeffff0f8e94feffff0f8e8efeffff0f8e88feffff0f8e82feffff66900f8e7afeffff0f8e74feffff0f8e6efeffff0f8e68feffff0f8e62feffff66900f8e5afeffff0f8e54feffff0f8e4efeffff0f8e48feffff0f8e42feffff66900f8e3afeffff0f8e34feffff0f8e2efeffff0f8e28feffff0f8e22feffff66900f8e1afeffff0f8e14feffff0f8e0efeffff0f8e08feffff0f8e02feffff66900f8efafdffff0f8ef4fdffff0f8eeefdffff0f8ee8fdffff0f8ee2fdffff66900f8edafdffff0f8ed4fdffff0f8ecefdffffc3",
			},
			{
				name:        "JLS",
				instruction: JLS,
				backward:    true,
				expectedHex: "c376fd76fb76f976f776f576f376f176ef76ed76eb76e976e776e576e376e19076de76dc76da76d876d676d476d276d076ce76cc76ca76c876c676c476c2669076be76bc76ba76b876b676b476b276b076ae76ac76aa76a876a676a476a26690769e769c769a76987696769476927690768e768c768a768876867684768266900f867affffff0f8674ffffff0f866effffff0f8668ffffff0f8662ffffff66900f865affffff0f8654ffffff0f864effffff0f8648ffffff0f8642ffffff66900f863affffff0f8634ffffff0f862effffff0f8628ffffff0f8622ffffff66900f861affffff0f8614ffffff0f860effffff0f8608ffffff0f8602ffffff66900f86fafeffff0f86f4feffff0f86eefeffff0f86e8feffff0f86e2feffff66900f86dafeffff0f86d4feffff0f86cefeffff0f86c8feffff0f86c2feffff66900f86bafeffff0f86b4feffff0f86aefeffff0f86a8feffff0f86a2feffff66900f869afeffff0f8694feffff0f868efeffff0f8688feffff0f8682feffff66900f867afeffff0f8674feffff0f866efeffff0f8668feffff0f8662feffff66900f865afeffff0f8654feffff0f864efeffff0f8648feffff0f8642feffff66900f863afeffff0f8634feffff0f862efeffff0f8628feffff0f8622feffff66900f861afeffff0f8614feffff0f860efeffff0f8608feffff0f8602feffff66900f86fafdffff0f86f4fdffff0f86eefdffff0f86e8fdffff0f86e2fdffff66900f86dafdffff0f86d4fdffff0f86cefdffffc3",
			},
			{
				name:        "JLT",
				instruction: JLT,
				backward:    true,
				expectedHex: "c37cfd7cfb7cf97cf77cf57cf37cf17cef7ced7ceb7ce97ce77ce57ce37ce1907cde7cdc7cda7cd87cd67cd47cd27cd07cce7ccc7cca7cc87cc67cc47cc266907cbe7cbc7cba7cb87cb67cb47cb27cb07cae7cac7caa7ca87ca67ca47ca266907c9e7c9c7c9a7c987c967c947c927c907c8e7c8c7c8a7c887c867c847c8266900f8c7affffff0f8c74ffffff0f8c6effffff0f8c68ffffff0f8c62ffffff66900f8c5affffff0f8c54ffffff0f8c4effffff0f8c48ffffff0f8c42ffffff66900f8c3affffff0f8c34ffffff0f8c2effffff0f8c28ffffff0f8c22ffffff66900f8c1affffff0f8c14ffffff0f8c0effffff0f8c08ffffff0f8c02ffffff66900f8cfafeffff0f8cf4feffff0f8ceefeffff0f8ce8feffff0f8ce2feffff66900f8cdafeffff0f8cd4feffff0f8ccefeffff0f8cc8feffff0f8cc2feffff66900f8cbafeffff0f8cb4feffff0f8caefeffff0f8ca8feffff0f8ca2feffff66900f8c9afeffff0f8c94feffff0f8c8efeffff0f8c88feffff0f8c82feffff66900f8c7afeffff0f8c74feffff0f8c6efeffff0f8c68feffff0f8c62feffff66900f8c5afeffff0f8c54feffff0f8c4efeffff0f8c48feffff0f8c42feffff66900f8c3afeffff0f8c34feffff0f8c2efeffff0f8c28feffff0f8c22feffff66900f8c1afeffff0f8c14feffff0f8c0efeffff0f8c08feffff0f8c02feffff66900f8cfafdffff0f8cf4fdffff0f8ceefdffff0f8ce8fdffff0f8ce2fdffff66900f8cdafdffff0f8cd4fdffff0f8ccefdffffc3",
			},
			{
				name:        "JMI",
				instruction: JMI,
				backward:    true,
				expectedHex: "c378fd78fb78f978f778f578f378f178ef78ed78eb78e978e778e578e378e19078de78dc78da78d878d678d478d278d078ce78cc78ca78c878c678c478c2669078be78bc78ba78b878b678b478b278b078ae78ac78aa78a878a678a478a26690789e789c789a78987896789478927890788e788c788a788878867884788266900f887affffff0f8874ffffff0f886effffff0f8868ffffff0f8862ffffff66900f885affffff0f8854ffffff0f884effffff0f8848ffffff0f8842ffffff66900f883affffff0f8834ffffff0f882effffff0f8828ffffff0f8822ffffff66900f881affffff0f8814ffffff0f880effffff0f8808ffffff0f8802ffffff66900f88fafeffff0f88f4feffff0f88eefeffff0f88e8feffff0f88e2feffff66900f88dafeffff0f88d4feffff0f88cefeffff0f88c8feffff0f88c2feffff66900f88bafeffff0f88b4feffff0f88aefeffff0f88a8feffff0f88a2feffff66900f889afeffff0f8894feffff0f888efeffff0f8888feffff0f8882feffff66900f887afeffff0f8874feffff0f886efeffff0f8868feffff0f8862feffff66900f885afeffff0f8854feffff0f884efeffff0f8848feffff0f8842feffff66900f883afeffff0f8834feffff0f882efeffff0f8828feffff0f8822feffff66900f881afeffff0f8814feffff0f880efeffff0f8808feffff0f8802feffff66900f88fafdffff0f88f4fdffff0f88eefdffff0f88e8fdffff0f88e2fdffff66900f88dafdffff0f88d4fdffff0f88cefdffffc3",
			},
			{
				name:        "JNE",
				instruction: JNE,
				backward:    true,
				expectedHex: "c375fd75fb75f975f775f575f375f175ef75ed75eb75e975e775e575e375e19075de75dc75da75d875d675d475d275d075ce75cc75ca75c875c675c475c2669075be75bc75ba75b875b675b475b275b075ae75ac75aa75a875a675a475a26690759e759c759a75987596759475927590758e758c758a758875867584758266900f857affffff0f8574ffffff0f856effffff0f8568ffffff0f8562ffffff66900f855affffff0f8554ffffff0f854effffff0f8548ffffff0f8542ffffff66900f853affffff0f8534ffffff0f852effffff0f8528ffffff0f8522ffffff66900f851affffff0f8514ffffff0f850effffff0f8508ffffff0f8502ffffff66900f85fafeffff0f85f4feffff0f85eefeffff0f85e8feffff0f85e2feffff66900f85dafeffff0f85d4feffff0f85cefeffff0f85c8feffff0f85c2feffff66900f85bafeffff0f85b4feffff0f85aefeffff0f85a8feffff0f85a2feffff66900f859afeffff0f8594feffff0f858efeffff0f8588feffff0f8582feffff66900f857afeffff0f8574feffff0f856efeffff0f8568feffff0f8562feffff66900f855afeffff0f8554feffff0f854efeffff0f8548feffff0f8542feffff66900f853afeffff0f8534feffff0f852efeffff0f8528feffff0f8522feffff66900f851afeffff0f8514feffff0f850efeffff0f8508feffff0f8502feffff66900f85fafdffff0f85f4fdffff0f85eefdffff0f85e8fdffff0f85e2fdffff66900f85dafdffff0f85d4fdffff0f85cefdffffc3",
			},
			{
				name:        "JPC",
				instruction: JPC,
				backward:    true,
				expectedHex: "c37bfd7bfb7bf97bf77bf57bf37bf17bef7bed7beb7be97be77be57be37be1907bde7bdc7bda7bd87bd67bd47bd27bd07bce7bcc7bca7bc87bc67bc47bc266907bbe7bbc7bba7bb87bb67bb47bb27bb07bae7bac7baa7ba87ba67ba47ba266907b9e7b9c7b9a7b987b967b947b927b907b8e7b8c7b8a7b887b867b847b8266900f8b7affffff0f8b74ffffff0f8b6effffff0f8b68ffffff0f8b62ffffff66900f8b5affffff0f8b54ffffff0f8b4effffff0f8b48ffffff0f8b42ffffff66900f8b3affffff0f8b34ffffff0f8b2effffff0f8b28ffffff0f8b22ffffff66900f8b1affffff0f8b14ffffff0f8b0effffff0f8b08ffffff0f8b02ffffff66900f8bfafeffff0f8bf4feffff0f8beefeffff0f8be8feffff0f8be2feffff66900f8bdafeffff0f8bd4feffff0f8bcefeffff0f8bc8feffff0f8bc2feffff66900f8bbafeffff0f8bb4feffff0f8baefeffff0f8ba8feffff0f8ba2feffff66900f8b9afeffff0f8b94feffff0f8b8efeffff0f8b88feffff0f8b82feffff66900f8b7afeffff0f8b74feffff0f8b6efeffff0f8b68feffff0f8b62feffff66900f8b5afeffff0f8b54feffff0f8b4efeffff0f8b48feffff0f8b42feffff66900f8b3afeffff0f8b34feffff0f8b2efeffff0f8b28feffff0f8b22feffff66900f8b1afeffff0f8b14feffff0f8b0efeffff0f8b08feffff0f8b02feffff66900f8bfafdffff0f8bf4fdffff0f8beefdffff0f8be8fdffff0f8be2fdffff66900f8bdafdffff0f8bd4fdffff0f8bcefdffffc3",
			},
			{
				name:        "JPS",
				instruction: JPS,
				backward:    true,
				expectedHex: "c37afd7afb7af97af77af57af37af17aef7aed7aeb7ae97ae77ae57ae37ae1907ade7adc7ada7ad87ad67ad47ad27ad07ace7acc7aca7ac87ac67ac47ac266907abe7abc7aba7ab87ab67ab47ab27ab07aae7aac7aaa7aa87aa67aa47aa266907a9e7a9c7a9a7a987a967a947a927a907a8e7a8c7a8a7a887a867a847a8266900f8a7affffff0f8a74ffffff0f8a6effffff0f8a68ffffff0f8a62ffffff66900f8a5affffff0f8a54ffffff0f8a4effffff0f8a48ffffff0f8a42ffffff66900f8a3affffff0f8a34ffffff0f8a2effffff0f8a28ffffff0f8a22ffffff66900f8a1affffff0f8a14ffffff0f8a0effffff0f8a08ffffff0f8a02ffffff66900f8afafeffff0f8af4feffff0f8aeefeffff0f8ae8feffff0f8ae2feffff66900f8adafeffff0f8ad4feffff0f8acefeffff0f8ac8feffff0f8ac2feffff66900f8abafeffff0f8ab4feffff0f8aaefeffff0f8aa8feffff0f8aa2feffff66900f8a9afeffff0f8a94feffff0f8a8efeffff0f8a88feffff0f8a82feffff66900f8a7afeffff0f8a74feffff0f8a6efeffff0f8a68feffff0f8a62feffff66900f8a5afeffff0f8a54feffff0f8a4efeffff0f8a48feffff0f8a42feffff66900f8a3afeffff0f8a34feffff0f8a2efeffff0f8a28feffff0f8a22feffff66900f8a1afeffff0f8a14feffff0f8a0efeffff0f8a08feffff0f8a02feffff66900f8afafdffff0f8af4fdffff0f8aeefdffff0f8ae8fdffff0f8ae2fdffff66900f8adafdffff0f8ad4fdffff0f8acefdffffc3",
			},
		}

		for _, tc := range cases {
			tc := tc
			t.Run(tc.name, func(t *testing.T) {
				a := NewAssemblerImpl()

				head := a.CompileStandAlone(RET)
				var jmps []asm.Node
				for i := 0; i < 128; i++ { // Large enough so that this includes long jump.
					jmps = append(jmps, a.CompileJump(tc.instruction))
				}
				tail := a.CompileStandAlone(RET)

				for _, jmp := range jmps {
					if tc.backward {
						jmp.AssignJumpTarget(head)
					} else {
						jmp.AssignJumpTarget(tail)
					}
				}

				actual, err := a.Assemble()
				require.NoError(t, err)

				require.Equal(t, tc.expectedHex, hex.EncodeToString(actual))
			})
		}
	})
}

func TestAssemblerImpl_Assemble_NOPPadding_fusedJumps(t *testing.T) {
	tests := []struct {
		name    string
		setupFn func(assembler Assembler)
	}{
		{
			name: "CMPL(register to const)",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToConst(CMPL, RegAX, math.MaxInt16)
			},
		},
		{
			name: "CMPL(memory to const)",
			setupFn: func(assembler Assembler) {
				assembler.CompileMemoryToConst(CMPL, RegAX, 1, 10)
			},
		},
		{
			name: "CMPL(register to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(CMPL, RegR14, RegR10)
			},
		},
		{
			name: "CMPQ(register to const)",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToConst(CMPQ, RegAX, math.MaxInt16)
			},
		},
		{
			name: "CMPQ(register to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(CMPQ, RegR14, RegR10)
			},
		},
		{
			name: "TESTL",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(TESTL, RegAX, RegAX)
			},
		},
		{
			name: "TESTQ",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(TESTQ, RegAX, RegAX)
			},
		},
		{
			name: "ADDL (register to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(ADDL, RegR10, RegAX)
			},
		},
		{
			name: "ADDL(memory to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileMemoryToRegister(ADDL, RegR10, 1234, RegAX)
			},
		},
		{
			name: "ADDQ (register to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(ADDQ, RegR10, RegAX)
			},
		},
		{
			name: "ADDQ(memory to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileMemoryToRegister(ADDQ, RegR10, 1234, RegAX)
			},
		},
		{
			name: "ADDQ(const to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileConstToRegister(ADDQ, 1234, RegR10)
			},
		},
		{
			name: "SUBL",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(SUBL, RegR10, RegAX)
			},
		},
		{
			name: "SUBQ (register to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(SUBQ, RegR10, RegAX)
			},
		},
		{
			name: "SUBQ (memory to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileMemoryToRegister(SUBQ, RegR10, math.MaxInt16, RegAX)
			},
		},
		{
			name: "ANDL",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(ANDL, RegR10, RegAX)
			},
		},
		{
			name: "ANDQ (register to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileRegisterToRegister(ANDQ, RegR10, RegAX)
			},
		},
		{
			name: "ANDQ (const to register)",
			setupFn: func(assembler Assembler) {
				assembler.CompileConstToRegister(ANDQ, -123, RegR10)
			},
		},
		{
			name: "INCQ",
			setupFn: func(assembler Assembler) {
				assembler.CompileNoneToMemory(INCQ, RegR10, 123)
			},
		},
		{
			name: "DECQ",
			setupFn: func(assembler Assembler) {
				assembler.CompileNoneToMemory(DECQ, RegR10, 0)
			},
		},
	}

	nameToInstToExpectedHexString := map[string]map[asm.Instruction]string{
		"CMPL(register to register)": map[asm.Instruction]string{
			JNE: "4539d675394539d675344539d6752f4539d6752a4539d675254539d6752066904539d675194539d675144539d6750f4539d6750a4539d675054539d67500c3",
			JPC: "4539d67b374539d67b324539d67b2d4539d67b284539d67b234539d67b1e4539d67b194539d67b144539d67b0f4539d67b0a4539d67b054539d67b00c3",
			JPS: "4539d67a374539d67a324539d67a2d4539d67a284539d67a234539d67a1e4539d67a194539d67a144539d67a0f4539d67a0a4539d67a054539d67a00c3",
			JLE: "4539d67e394539d67e344539d67e2f4539d67e2a4539d67e254539d67e2066904539d67e194539d67e144539d67e0f4539d67e0a4539d67e054539d67e00c3",
			JLS: "4539d676394539d676344539d6762f4539d6762a4539d676254539d6762066904539d676194539d676144539d6760f4539d6760a4539d676054539d67600c3",
			JLT: "4539d67c394539d67c344539d67c2f4539d67c2a4539d67c254539d67c2066904539d67c194539d67c144539d67c0f4539d67c0a4539d67c054539d67c00c3",
			JGE: "4539d67d394539d67d344539d67d2f4539d67d2a4539d67d254539d67d2066904539d67d194539d67d144539d67d0f4539d67d0a4539d67d054539d67d00c3",
			JGT: "4539d67f394539d67f344539d67f2f4539d67f2a4539d67f254539d67f2066904539d67f194539d67f144539d67f0f4539d67f0a4539d67f054539d67f00c3",
			JHI: "4539d677394539d677344539d6772f4539d6772a4539d677254539d6772066904539d677194539d677144539d6770f4539d6770a4539d677054539d67700c3",
			JMI: "4539d678374539d678324539d6782d4539d678284539d678234539d6781e4539d678194539d678144539d6780f4539d6780a4539d678054539d67800c3",
			JCC: "4539d673394539d673344539d6732f4539d6732a4539d673254539d6732066904539d673194539d673144539d6730f4539d6730a4539d673054539d67300c3",
			JCS: "4539d672394539d672344539d6722f4539d6722a4539d672254539d6722066904539d672194539d672144539d6720f4539d6720a4539d672054539d67200c3",
			JEQ: "4539d674394539d674344539d6742f4539d6742a4539d674254539d6742066904539d674194539d674144539d6740f4539d6740a4539d674054539d67400c3"},
		"CMPQ(register to const)": map[asm.Instruction]string{
			JCS: "483dff7f00007270483dff7f00007268483dff7f000072600f1f840000000000483dff7f00007250483dff7f00007248483dff7f000072400f1f840000000000483dff7f00007230483dff7f00007228483dff7f000072200f1f840000000000483dff7f00007210483dff7f00007208483dff7f00007200c3",
			JEQ: "483dff7f00007470483dff7f00007468483dff7f000074600f1f840000000000483dff7f00007450483dff7f00007448483dff7f000074400f1f840000000000483dff7f00007430483dff7f00007428483dff7f000074200f1f840000000000483dff7f00007410483dff7f00007408483dff7f00007400c3",
			JGE: "483dff7f00007d70483dff7f00007d68483dff7f00007d600f1f840000000000483dff7f00007d50483dff7f00007d48483dff7f00007d400f1f840000000000483dff7f00007d30483dff7f00007d28483dff7f00007d200f1f840000000000483dff7f00007d10483dff7f00007d08483dff7f00007d00c3",
			JGT: "483dff7f00007f70483dff7f00007f68483dff7f00007f600f1f840000000000483dff7f00007f50483dff7f00007f48483dff7f00007f400f1f840000000000483dff7f00007f30483dff7f00007f28483dff7f00007f200f1f840000000000483dff7f00007f10483dff7f00007f08483dff7f00007f00c3",
			JHI: "483dff7f00007770483dff7f00007768483dff7f000077600f1f840000000000483dff7f00007750483dff7f00007748483dff7f000077400f1f840000000000483dff7f00007730483dff7f00007728483dff7f000077200f1f840000000000483dff7f00007710483dff7f00007708483dff7f00007700c3",
			JLE: "483dff7f00007e70483dff7f00007e68483dff7f00007e600f1f840000000000483dff7f00007e50483dff7f00007e48483dff7f00007e400f1f840000000000483dff7f00007e30483dff7f00007e28483dff7f00007e200f1f840000000000483dff7f00007e10483dff7f00007e08483dff7f00007e00c3",
			JLS: "483dff7f00007670483dff7f00007668483dff7f000076600f1f840000000000483dff7f00007650483dff7f00007648483dff7f000076400f1f840000000000483dff7f00007630483dff7f00007628483dff7f000076200f1f840000000000483dff7f00007610483dff7f00007608483dff7f00007600c3",
			JNE: "483dff7f00007570483dff7f00007568483dff7f000075600f1f840000000000483dff7f00007550483dff7f00007548483dff7f000075400f1f840000000000483dff7f00007530483dff7f00007528483dff7f000075200f1f840000000000483dff7f00007510483dff7f00007508483dff7f00007500c3",
			JCC: "483dff7f00007370483dff7f00007368483dff7f000073600f1f840000000000483dff7f00007350483dff7f00007348483dff7f000073400f1f840000000000483dff7f00007330483dff7f00007328483dff7f000073200f1f840000000000483dff7f00007310483dff7f00007308483dff7f00007300c3",
			JLT: "483dff7f00007c70483dff7f00007c68483dff7f00007c600f1f840000000000483dff7f00007c50483dff7f00007c48483dff7f00007c400f1f840000000000483dff7f00007c30483dff7f00007c28483dff7f00007c200f1f840000000000483dff7f00007c10483dff7f00007c08483dff7f00007c00c3",
			JMI: "483dff7f0000785a483dff7f00007852483dff7f0000784a483dff7f000066907840483dff7f00007838483dff7f00007830483dff7f00007828483dff7f00007820483dff7f00007818483dff7f00007810483dff7f00007808483dff7f00007800c3",
			JPC: "483dff7f00007b5a483dff7f00007b52483dff7f00007b4a483dff7f000066907b40483dff7f00007b38483dff7f00007b30483dff7f00007b28483dff7f00007b20483dff7f00007b18483dff7f00007b10483dff7f00007b08483dff7f00007b00c3",
			JPS: "483dff7f00007a5a483dff7f00007a52483dff7f00007a4a483dff7f000066907a40483dff7f00007a38483dff7f00007a30483dff7f00007a28483dff7f00007a20483dff7f00007a18483dff7f00007a10483dff7f00007a08483dff7f00007a00c3"},
		"ADDL (register to register)": map[asm.Instruction]string{
			JCC: "4401d073394401d073344401d0732f4401d0732a4401d073254401d0732066904401d073194401d073144401d0730f4401d0730a4401d073054401d07300c3",
			JCS: "4401d072394401d072344401d0722f4401d0722a4401d072254401d0722066904401d072194401d072144401d0720f4401d0720a4401d072054401d07200c3",
			JGE: "4401d07d394401d07d344401d07d2f4401d07d2a4401d07d254401d07d2066904401d07d194401d07d144401d07d0f4401d07d0a4401d07d054401d07d00c3",
			JGT: "4401d07f394401d07f344401d07f2f4401d07f2a4401d07f254401d07f2066904401d07f194401d07f144401d07f0f4401d07f0a4401d07f054401d07f00c3",
			JLE: "4401d07e394401d07e344401d07e2f4401d07e2a4401d07e254401d07e2066904401d07e194401d07e144401d07e0f4401d07e0a4401d07e054401d07e00c3",
			JPS: "4401d07a374401d07a324401d07a2d4401d07a284401d07a234401d07a1e4401d07a194401d07a144401d07a0f4401d07a0a4401d07a054401d07a00c3",
			JEQ: "4401d074394401d074344401d0742f4401d0742a4401d074254401d0742066904401d074194401d074144401d0740f4401d0740a4401d074054401d07400c3",
			JHI: "4401d077394401d077344401d0772f4401d0772a4401d077254401d0772066904401d077194401d077144401d0770f4401d0770a4401d077054401d07700c3",
			JLS: "4401d076394401d076344401d0762f4401d0762a4401d076254401d0762066904401d076194401d076144401d0760f4401d0760a4401d076054401d07600c3",
			JLT: "4401d07c394401d07c344401d07c2f4401d07c2a4401d07c254401d07c2066904401d07c194401d07c144401d07c0f4401d07c0a4401d07c054401d07c00c3",
			JMI: "4401d078374401d078324401d0782d4401d078284401d078234401d0781e4401d078194401d078144401d0780f4401d0780a4401d078054401d07800c3",
			JNE: "4401d075394401d075344401d0752f4401d0752a4401d075254401d0752066904401d075194401d075144401d0750f4401d0750a4401d075054401d07500c3",
			JPC: "4401d07b374401d07b324401d07b2d4401d07b284401d07b234401d07b1e4401d07b194401d07b144401d07b0f4401d07b0a4401d07b054401d07b00c3"},
		"SUBL": map[asm.Instruction]string{
			JEQ: "4429d074394429d074344429d0742f4429d0742a4429d074254429d0742066904429d074194429d074144429d0740f4429d0740a4429d074054429d07400c3",
			JGE: "4429d07d394429d07d344429d07d2f4429d07d2a4429d07d254429d07d2066904429d07d194429d07d144429d07d0f4429d07d0a4429d07d054429d07d00c3",
			JGT: "4429d07f394429d07f344429d07f2f4429d07f2a4429d07f254429d07f2066904429d07f194429d07f144429d07f0f4429d07f0a4429d07f054429d07f00c3",
			JLS: "4429d076394429d076344429d0762f4429d0762a4429d076254429d0762066904429d076194429d076144429d0760f4429d0760a4429d076054429d07600c3",
			JLT: "4429d07c394429d07c344429d07c2f4429d07c2a4429d07c254429d07c2066904429d07c194429d07c144429d07c0f4429d07c0a4429d07c054429d07c00c3",
			JPC: "4429d07b374429d07b324429d07b2d4429d07b284429d07b234429d07b1e4429d07b194429d07b144429d07b0f4429d07b0a4429d07b054429d07b00c3",
			JCC: "4429d073394429d073344429d0732f4429d0732a4429d073254429d0732066904429d073194429d073144429d0730f4429d0730a4429d073054429d07300c3",
			JCS: "4429d072394429d072344429d0722f4429d0722a4429d072254429d0722066904429d072194429d072144429d0720f4429d0720a4429d072054429d07200c3",
			JPS: "4429d07a374429d07a324429d07a2d4429d07a284429d07a234429d07a1e4429d07a194429d07a144429d07a0f4429d07a0a4429d07a054429d07a00c3",
			JMI: "4429d078374429d078324429d0782d4429d078284429d078234429d0781e4429d078194429d078144429d0780f4429d0780a4429d078054429d07800c3",
			JNE: "4429d075394429d075344429d0752f4429d0752a4429d075254429d0752066904429d075194429d075144429d0750f4429d0750a4429d075054429d07500c3",
			JHI: "4429d077394429d077344429d0772f4429d0772a4429d077254429d0772066904429d077194429d077144429d0770f4429d0770a4429d077054429d07700c3",
			JLE: "4429d07e394429d07e344429d07e2f4429d07e2a4429d07e254429d07e2066904429d07e194429d07e144429d07e0f4429d07e0a4429d07e054429d07e00c3"},
		"ANDQ (register to register)": map[asm.Instruction]string{
			JGE: "4c21d07d394c21d07d344c21d07d2f4c21d07d2a4c21d07d254c21d07d2066904c21d07d194c21d07d144c21d07d0f4c21d07d0a4c21d07d054c21d07d00c3",
			JLE: "4c21d07e394c21d07e344c21d07e2f4c21d07e2a4c21d07e254c21d07e2066904c21d07e194c21d07e144c21d07e0f4c21d07e0a4c21d07e054c21d07e00c3",
			JLT: "4c21d07c394c21d07c344c21d07c2f4c21d07c2a4c21d07c254c21d07c2066904c21d07c194c21d07c144c21d07c0f4c21d07c0a4c21d07c054c21d07c00c3",
			JMI: "4c21d078394c21d078344c21d0782f4c21d0782a4c21d078254c21d0782066904c21d078194c21d078144c21d0780f4c21d0780a4c21d078054c21d07800c3",
			JNE: "4c21d075394c21d075344c21d0752f4c21d0752a4c21d075254c21d0752066904c21d075194c21d075144c21d0750f4c21d0750a4c21d075054c21d07500c3",
			JPC: "4c21d07b394c21d07b344c21d07b2f4c21d07b2a4c21d07b254c21d07b2066904c21d07b194c21d07b144c21d07b0f4c21d07b0a4c21d07b054c21d07b00c3",
			JCC: "4c21d073394c21d073344c21d0732f4c21d0732a4c21d073254c21d0732066904c21d073194c21d073144c21d0730f4c21d0730a4c21d073054c21d07300c3",
			JEQ: "4c21d074394c21d074344c21d0742f4c21d0742a4c21d074254c21d0742066904c21d074194c21d074144c21d0740f4c21d0740a4c21d074054c21d07400c3",
			JHI: "4c21d077394c21d077344c21d0772f4c21d0772a4c21d077254c21d0772066904c21d077194c21d077144c21d0770f4c21d0770a4c21d077054c21d07700c3",
			JLS: "4c21d076394c21d076344c21d0762f4c21d0762a4c21d076254c21d0762066904c21d076194c21d076144c21d0760f4c21d0760a4c21d076054c21d07600c3",
			JPS: "4c21d07a394c21d07a344c21d07a2f4c21d07a2a4c21d07a254c21d07a2066904c21d07a194c21d07a144c21d07a0f4c21d07a0a4c21d07a054c21d07a00c3",
			JCS: "4c21d072394c21d072344c21d0722f4c21d0722a4c21d072254c21d0722066904c21d072194c21d072144c21d0720f4c21d0720a4c21d072054c21d07200c3",
			JGT: "4c21d07f394c21d07f344c21d07f2f4c21d07f2a4c21d07f254c21d07f2066904c21d07f194c21d07f144c21d07f0f4c21d07f0a4c21d07f054c21d07f00c3"},
		"CMPL(register to const)": map[asm.Instruction]string{
			JLS: "3dff7f000076553dff7f0000764e3dff7f000076473dff7f000076400f1f40003dff7f000076353dff7f0000762e3dff7f000076273dff7f000076200f1f40003dff7f000076153dff7f0000760e3dff7f000076073dff7f00007600c3",
			JLT: "3dff7f00007c553dff7f00007c4e3dff7f00007c473dff7f00007c400f1f40003dff7f00007c353dff7f00007c2e3dff7f00007c273dff7f00007c200f1f40003dff7f00007c153dff7f00007c0e3dff7f00007c073dff7f00007c00c3",
			JMI: "3dff7f0000784d3dff7f000078463dff7f0000783f3dff7f000078383dff7f000078313dff7f0000782a3dff7f000078233dff7f0000781c3dff7f000078153dff7f0000780e3dff7f000078073dff7f00007800c3",
			JNE: "3dff7f000075553dff7f0000754e3dff7f000075473dff7f000075400f1f40003dff7f000075353dff7f0000752e3dff7f000075273dff7f000075200f1f40003dff7f000075153dff7f0000750e3dff7f000075073dff7f00007500c3",
			JGE: "3dff7f00007d553dff7f00007d4e3dff7f00007d473dff7f00007d400f1f40003dff7f00007d353dff7f00007d2e3dff7f00007d273dff7f00007d200f1f40003dff7f00007d153dff7f00007d0e3dff7f00007d073dff7f00007d00c3",
			JGT: "3dff7f00007f553dff7f00007f4e3dff7f00007f473dff7f00007f400f1f40003dff7f00007f353dff7f00007f2e3dff7f00007f273dff7f00007f200f1f40003dff7f00007f153dff7f00007f0e3dff7f00007f073dff7f00007f00c3",
			JHI: "3dff7f000077553dff7f0000774e3dff7f000077473dff7f000077400f1f40003dff7f000077353dff7f0000772e3dff7f000077273dff7f000077200f1f40003dff7f000077153dff7f0000770e3dff7f000077073dff7f00007700c3",
			JLE: "3dff7f00007e553dff7f00007e4e3dff7f00007e473dff7f00007e400f1f40003dff7f00007e353dff7f00007e2e3dff7f00007e273dff7f00007e200f1f40003dff7f00007e153dff7f00007e0e3dff7f00007e073dff7f00007e00c3",
			JPC: "3dff7f00007b4d3dff7f00007b463dff7f00007b3f3dff7f00007b383dff7f00007b313dff7f00007b2a3dff7f00007b233dff7f00007b1c3dff7f00007b153dff7f00007b0e3dff7f00007b073dff7f00007b00c3",
			JPS: "3dff7f00007a4d3dff7f00007a463dff7f00007a3f3dff7f00007a383dff7f00007a313dff7f00007a2a3dff7f00007a233dff7f00007a1c3dff7f00007a153dff7f00007a0e3dff7f00007a073dff7f00007a00c3",
			JCC: "3dff7f000073553dff7f0000734e3dff7f000073473dff7f000073400f1f40003dff7f000073353dff7f0000732e3dff7f000073273dff7f000073200f1f40003dff7f000073153dff7f0000730e3dff7f000073073dff7f00007300c3",
			JCS: "3dff7f000072553dff7f0000724e3dff7f000072473dff7f000072400f1f40003dff7f000072353dff7f0000722e3dff7f000072273dff7f000072200f1f40003dff7f000072153dff7f0000720e3dff7f000072073dff7f00007200c3",
			JEQ: "3dff7f000074553dff7f0000744e3dff7f000074473dff7f000074400f1f40003dff7f000074353dff7f0000742e3dff7f000074273dff7f000074200f1f40003dff7f000074153dff7f0000740e3dff7f000074073dff7f00007400c3"},
		"CMPQ(register to register)": map[asm.Instruction]string{
			JCC: "4d39d673394d39d673344d39d6732f4d39d6732a4d39d673254d39d6732066904d39d673194d39d673144d39d6730f4d39d6730a4d39d673054d39d67300c3",
			JLE: "4d39d67e394d39d67e344d39d67e2f4d39d67e2a4d39d67e254d39d67e2066904d39d67e194d39d67e144d39d67e0f4d39d67e0a4d39d67e054d39d67e00c3",
			JMI: "4d39d678374d39d678324d39d6782d4d39d678284d39d678234d39d6781e4d39d678194d39d678144d39d6780f4d39d6780a4d39d678054d39d67800c3",
			JNE: "4d39d675394d39d675344d39d6752f4d39d6752a4d39d675254d39d6752066904d39d675194d39d675144d39d6750f4d39d6750a4d39d675054d39d67500c3",
			JLS: "4d39d676394d39d676344d39d6762f4d39d6762a4d39d676254d39d6762066904d39d676194d39d676144d39d6760f4d39d6760a4d39d676054d39d67600c3",
			JLT: "4d39d67c394d39d67c344d39d67c2f4d39d67c2a4d39d67c254d39d67c2066904d39d67c194d39d67c144d39d67c0f4d39d67c0a4d39d67c054d39d67c00c3",
			JPC: "4d39d67b374d39d67b324d39d67b2d4d39d67b284d39d67b234d39d67b1e4d39d67b194d39d67b144d39d67b0f4d39d67b0a4d39d67b054d39d67b00c3",
			JCS: "4d39d672394d39d672344d39d6722f4d39d6722a4d39d672254d39d6722066904d39d672194d39d672144d39d6720f4d39d6720a4d39d672054d39d67200c3",
			JEQ: "4d39d674394d39d674344d39d6742f4d39d6742a4d39d674254d39d6742066904d39d674194d39d674144d39d6740f4d39d6740a4d39d674054d39d67400c3",
			JGE: "4d39d67d394d39d67d344d39d67d2f4d39d67d2a4d39d67d254d39d67d2066904d39d67d194d39d67d144d39d67d0f4d39d67d0a4d39d67d054d39d67d00c3",
			JGT: "4d39d67f394d39d67f344d39d67f2f4d39d67f2a4d39d67f254d39d67f2066904d39d67f194d39d67f144d39d67f0f4d39d67f0a4d39d67f054d39d67f00c3",
			JHI: "4d39d677394d39d677344d39d6772f4d39d6772a4d39d677254d39d6772066904d39d677194d39d677144d39d6770f4d39d6770a4d39d677054d39d67700c3",
			JPS: "4d39d67a374d39d67a324d39d67a2d4d39d67a284d39d67a234d39d67a1e4d39d67a194d39d67a144d39d67a0f4d39d67a0a4d39d67a054d39d67a00c3"},
		"ADDQ(memory to register)": map[asm.Instruction]string{
			JNE: "490382d20400007572490382d20400007569490382d204000075600f1f440000490382d20400007552490382d20400007549490382d204000075400f1f440000490382d20400007532490382d20400007529490382d204000075200f1f440000490382d20400007512490382d20400007509490382d20400007500c3",
			JCS: "490382d20400007272490382d20400007269490382d204000072600f1f440000490382d20400007252490382d20400007249490382d204000072400f1f440000490382d20400007232490382d20400007229490382d204000072200f1f440000490382d20400007212490382d20400007209490382d20400007200c3",
			JGE: "490382d20400007d72490382d20400007d69490382d20400007d600f1f440000490382d20400007d52490382d20400007d49490382d20400007d400f1f440000490382d20400007d32490382d20400007d29490382d20400007d200f1f440000490382d20400007d12490382d20400007d09490382d20400007d00c3",
			JHI: "490382d20400007772490382d20400007769490382d204000077600f1f440000490382d20400007752490382d20400007749490382d204000077400f1f440000490382d20400007732490382d20400007729490382d204000077200f1f440000490382d20400007712490382d20400007709490382d20400007700c3",
			JLT: "490382d20400007c72490382d20400007c69490382d20400007c600f1f440000490382d20400007c52490382d20400007c49490382d20400007c400f1f440000490382d20400007c32490382d20400007c29490382d20400007c200f1f440000490382d20400007c12490382d20400007c09490382d20400007c00c3",
			JMI: "490382d20400007863490382d2040000785a490382d20400007851490382d20400007848490382d2040000783f490382d20400007836490382d2040000782d490382d20400007824490382d2040000781b490382d20400007812490382d20400007809490382d20400007800c3",
			JPC: "490382d20400007b63490382d20400007b5a490382d20400007b51490382d20400007b48490382d20400007b3f490382d20400007b36490382d20400007b2d490382d20400007b24490382d20400007b1b490382d20400007b12490382d20400007b09490382d20400007b00c3",
			JPS: "490382d20400007a63490382d20400007a5a490382d20400007a51490382d20400007a48490382d20400007a3f490382d20400007a36490382d20400007a2d490382d20400007a24490382d20400007a1b490382d20400007a12490382d20400007a09490382d20400007a00c3",
			JCC: "490382d20400007372490382d20400007369490382d204000073600f1f440000490382d20400007352490382d20400007349490382d204000073400f1f440000490382d20400007332490382d20400007329490382d204000073200f1f440000490382d20400007312490382d20400007309490382d20400007300c3",
			JEQ: "490382d20400007472490382d20400007469490382d204000074600f1f440000490382d20400007452490382d20400007449490382d204000074400f1f440000490382d20400007432490382d20400007429490382d204000074200f1f440000490382d20400007412490382d20400007409490382d20400007400c3",
			JGT: "490382d20400007f72490382d20400007f69490382d20400007f600f1f440000490382d20400007f52490382d20400007f49490382d20400007f400f1f440000490382d20400007f32490382d20400007f29490382d20400007f200f1f440000490382d20400007f12490382d20400007f09490382d20400007f00c3",
			JLE: "490382d20400007e72490382d20400007e69490382d20400007e600f1f440000490382d20400007e52490382d20400007e49490382d20400007e400f1f440000490382d20400007e32490382d20400007e29490382d20400007e200f1f440000490382d20400007e12490382d20400007e09490382d20400007e00c3",
			JLS: "490382d20400007672490382d20400007669490382d204000076600f1f440000490382d20400007652490382d20400007649490382d204000076400f1f440000490382d20400007632490382d20400007629490382d204000076200f1f440000490382d20400007612490382d20400007609490382d20400007600c3"},
		"ANDQ (const to register)": map[asm.Instruction]string{
			JHI: "4983e28577464983e28577404983e285773a4983e28577344983e285772e66904983e28577264983e28577204983e285771a4983e28577144983e285770e66904983e28577064983e2857700c3",
			JLE: "4983e2857e464983e2857e404983e2857e3a4983e2857e344983e2857e2e66904983e2857e264983e2857e204983e2857e1a4983e2857e144983e2857e0e66904983e2857e064983e2857e00c3",
			JLT: "4983e2857c464983e2857c404983e2857c3a4983e2857c344983e2857c2e66904983e2857c264983e2857c204983e2857c1a4983e2857c144983e2857c0e66904983e2857c064983e2857c00c3",
			JMI: "4983e28578464983e28578404983e285783a4983e28578344983e285782e66904983e28578264983e28578204983e285781a4983e28578144983e285780e66904983e28578064983e2857800c3",
			JNE: "4983e28575464983e28575404983e285753a4983e28575344983e285752e66904983e28575264983e28575204983e285751a4983e28575144983e285750e66904983e28575064983e2857500c3",
			JCS: "4983e28572464983e28572404983e285723a4983e28572344983e285722e66904983e28572264983e28572204983e285721a4983e28572144983e285720e66904983e28572064983e2857200c3",
			JGE: "4983e2857d464983e2857d404983e2857d3a4983e2857d344983e2857d2e66904983e2857d264983e2857d204983e2857d1a4983e2857d144983e2857d0e66904983e2857d064983e2857d00c3",
			JGT: "4983e2857f464983e2857f404983e2857f3a4983e2857f344983e2857f2e66904983e2857f264983e2857f204983e2857f1a4983e2857f144983e2857f0e66904983e2857f064983e2857f00c3",
			JPC: "4983e2857b464983e2857b404983e2857b3a4983e2857b344983e2857b2e66904983e2857b264983e2857b204983e2857b1a4983e2857b144983e2857b0e66904983e2857b064983e2857b00c3",
			JPS: "4983e2857a464983e2857a404983e2857a3a4983e2857a344983e2857a2e66904983e2857a264983e2857a204983e2857a1a4983e2857a144983e2857a0e66904983e2857a064983e2857a00c3",
			JCC: "4983e28573464983e28573404983e285733a4983e28573344983e285732e66904983e28573264983e28573204983e285731a4983e28573144983e285730e66904983e28573064983e2857300c3",
			JEQ: "4983e28574464983e28574404983e285743a4983e28574344983e285742e66904983e28574264983e28574204983e285741a4983e28574144983e285740e66904983e28574064983e2857400c3",
			JLS: "4983e28576464983e28576404983e285763a4983e28576344983e285762e66904983e28576264983e28576204983e285761a4983e28576144983e285760e66904983e28576064983e2857600c3"},
		"INCQ": map[asm.Instruction]string{
			JLS: "49ff427b764249ff427b763c49ff427b763649ff427b763049ff427b762a49ff427b762449ff427b761e49ff427b761849ff427b761249ff427b760c49ff427b760649ff427b7600c3",
			JLT: "49ff427b7c4649ff427b7c4049ff427b7c3a49ff427b7c3449ff427b7c2e669049ff427b7c2649ff427b7c2049ff427b7c1a49ff427b7c1449ff427b7c0e669049ff427b7c0649ff427b7c00c3",
			JCC: "49ff427b734249ff427b733c49ff427b733649ff427b733049ff427b732a49ff427b732449ff427b731e49ff427b731849ff427b731249ff427b730c49ff427b730649ff427b7300c3",
			JEQ: "49ff427b744649ff427b744049ff427b743a49ff427b743449ff427b742e669049ff427b742649ff427b742049ff427b741a49ff427b741449ff427b740e669049ff427b740649ff427b7400c3",
			JGE: "49ff427b7d4649ff427b7d4049ff427b7d3a49ff427b7d3449ff427b7d2e669049ff427b7d2649ff427b7d2049ff427b7d1a49ff427b7d1449ff427b7d0e669049ff427b7d0649ff427b7d00c3",
			JGT: "49ff427b7f4649ff427b7f4049ff427b7f3a49ff427b7f3449ff427b7f2e669049ff427b7f2649ff427b7f2049ff427b7f1a49ff427b7f1449ff427b7f0e669049ff427b7f0649ff427b7f00c3",
			JHI: "49ff427b774249ff427b773c49ff427b773649ff427b773049ff427b772a49ff427b772449ff427b771e49ff427b771849ff427b771249ff427b770c49ff427b770649ff427b7700c3",
			JLE: "49ff427b7e4649ff427b7e4049ff427b7e3a49ff427b7e3449ff427b7e2e669049ff427b7e2649ff427b7e2049ff427b7e1a49ff427b7e1449ff427b7e0e669049ff427b7e0649ff427b7e00c3",
			JMI: "49ff427b784249ff427b783c49ff427b783649ff427b783049ff427b782a49ff427b782449ff427b781e49ff427b781849ff427b781249ff427b780c49ff427b780649ff427b7800c3",
			JNE: "49ff427b754649ff427b754049ff427b753a49ff427b753449ff427b752e669049ff427b752649ff427b752049ff427b751a49ff427b751449ff427b750e669049ff427b750649ff427b7500c3",
			JCS: "49ff427b724249ff427b723c49ff427b723649ff427b723049ff427b722a49ff427b722449ff427b721e49ff427b721849ff427b721249ff427b720c49ff427b720649ff427b7200c3",
			JPC: "49ff427b7b4249ff427b7b3c49ff427b7b3649ff427b7b3049ff427b7b2a49ff427b7b2449ff427b7b1e49ff427b7b1849ff427b7b1249ff427b7b0c49ff427b7b0649ff427b7b00c3",
			JPS: "49ff427b7a4249ff427b7a3c49ff427b7a3649ff427b7a3049ff427b7a2a49ff427b7a2449ff427b7a1e49ff427b7a1849ff427b7a1249ff427b7a0c49ff427b7a0649ff427b7a00c3"},
		"SUBQ (memory to register)": map[asm.Instruction]string{
			JCS: "492b82ff7f00007272492b82ff7f00007269492b82ff7f000072600f1f440000492b82ff7f00007252492b82ff7f00007249492b82ff7f000072400f1f440000492b82ff7f00007232492b82ff7f00007229492b82ff7f000072200f1f440000492b82ff7f00007212492b82ff7f00007209492b82ff7f00007200c3",
			JEQ: "492b82ff7f00007472492b82ff7f00007469492b82ff7f000074600f1f440000492b82ff7f00007452492b82ff7f00007449492b82ff7f000074400f1f440000492b82ff7f00007432492b82ff7f00007429492b82ff7f000074200f1f440000492b82ff7f00007412492b82ff7f00007409492b82ff7f00007400c3",
			JGE: "492b82ff7f00007d72492b82ff7f00007d69492b82ff7f00007d600f1f440000492b82ff7f00007d52492b82ff7f00007d49492b82ff7f00007d400f1f440000492b82ff7f00007d32492b82ff7f00007d29492b82ff7f00007d200f1f440000492b82ff7f00007d12492b82ff7f00007d09492b82ff7f00007d00c3",
			JGT: "492b82ff7f00007f72492b82ff7f00007f69492b82ff7f00007f600f1f440000492b82ff7f00007f52492b82ff7f00007f49492b82ff7f00007f400f1f440000492b82ff7f00007f32492b82ff7f00007f29492b82ff7f00007f200f1f440000492b82ff7f00007f12492b82ff7f00007f09492b82ff7f00007f00c3",
			JHI: "492b82ff7f00007772492b82ff7f00007769492b82ff7f000077600f1f440000492b82ff7f00007752492b82ff7f00007749492b82ff7f000077400f1f440000492b82ff7f00007732492b82ff7f00007729492b82ff7f000077200f1f440000492b82ff7f00007712492b82ff7f00007709492b82ff7f00007700c3",
			JLE: "492b82ff7f00007e72492b82ff7f00007e69492b82ff7f00007e600f1f440000492b82ff7f00007e52492b82ff7f00007e49492b82ff7f00007e400f1f440000492b82ff7f00007e32492b82ff7f00007e29492b82ff7f00007e200f1f440000492b82ff7f00007e12492b82ff7f00007e09492b82ff7f00007e00c3",
			JLT: "492b82ff7f00007c72492b82ff7f00007c69492b82ff7f00007c600f1f440000492b82ff7f00007c52492b82ff7f00007c49492b82ff7f00007c400f1f440000492b82ff7f00007c32492b82ff7f00007c29492b82ff7f00007c200f1f440000492b82ff7f00007c12492b82ff7f00007c09492b82ff7f00007c00c3",
			JMI: "492b82ff7f00007863492b82ff7f0000785a492b82ff7f00007851492b82ff7f00007848492b82ff7f0000783f492b82ff7f00007836492b82ff7f0000782d492b82ff7f00007824492b82ff7f0000781b492b82ff7f00007812492b82ff7f00007809492b82ff7f00007800c3",
			JPC: "492b82ff7f00007b63492b82ff7f00007b5a492b82ff7f00007b51492b82ff7f00007b48492b82ff7f00007b3f492b82ff7f00007b36492b82ff7f00007b2d492b82ff7f00007b24492b82ff7f00007b1b492b82ff7f00007b12492b82ff7f00007b09492b82ff7f00007b00c3",
			JPS: "492b82ff7f00007a63492b82ff7f00007a5a492b82ff7f00007a51492b82ff7f00007a48492b82ff7f00007a3f492b82ff7f00007a36492b82ff7f00007a2d492b82ff7f00007a24492b82ff7f00007a1b492b82ff7f00007a12492b82ff7f00007a09492b82ff7f00007a00c3",
			JCC: "492b82ff7f00007372492b82ff7f00007369492b82ff7f000073600f1f440000492b82ff7f00007352492b82ff7f00007349492b82ff7f000073400f1f440000492b82ff7f00007332492b82ff7f00007329492b82ff7f000073200f1f440000492b82ff7f00007312492b82ff7f00007309492b82ff7f00007300c3",
			JLS: "492b82ff7f00007672492b82ff7f00007669492b82ff7f000076600f1f440000492b82ff7f00007652492b82ff7f00007649492b82ff7f000076400f1f440000492b82ff7f00007632492b82ff7f00007629492b82ff7f000076200f1f440000492b82ff7f00007612492b82ff7f00007609492b82ff7f00007600c3",
			JNE: "492b82ff7f00007572492b82ff7f00007569492b82ff7f000075600f1f440000492b82ff7f00007552492b82ff7f00007549492b82ff7f000075400f1f440000492b82ff7f00007532492b82ff7f00007529492b82ff7f000075200f1f440000492b82ff7f00007512492b82ff7f00007509492b82ff7f00007500c3"},
		"ANDL": map[asm.Instruction]string{
			JCS: "4421d072394421d072344421d0722f4421d0722a4421d072254421d0722066904421d072194421d072144421d0720f4421d0720a4421d072054421d07200c3",
			JEQ: "4421d074394421d074344421d0742f4421d0742a4421d074254421d0742066904421d074194421d074144421d0740f4421d0740a4421d074054421d07400c3",
			JGE: "4421d07d394421d07d344421d07d2f4421d07d2a4421d07d254421d07d2066904421d07d194421d07d144421d07d0f4421d07d0a4421d07d054421d07d00c3",
			JGT: "4421d07f394421d07f344421d07f2f4421d07f2a4421d07f254421d07f2066904421d07f194421d07f144421d07f0f4421d07f0a4421d07f054421d07f00c3",
			JLE: "4421d07e394421d07e344421d07e2f4421d07e2a4421d07e254421d07e2066904421d07e194421d07e144421d07e0f4421d07e0a4421d07e054421d07e00c3",
			JLT: "4421d07c394421d07c344421d07c2f4421d07c2a4421d07c254421d07c2066904421d07c194421d07c144421d07c0f4421d07c0a4421d07c054421d07c00c3",
			JMI: "4421d078394421d078344421d0782f4421d0782a4421d078254421d0782066904421d078194421d078144421d0780f4421d0780a4421d078054421d07800c3",
			JPS: "4421d07a394421d07a344421d07a2f4421d07a2a4421d07a254421d07a2066904421d07a194421d07a144421d07a0f4421d07a0a4421d07a054421d07a00c3",
			JCC: "4421d073394421d073344421d0732f4421d0732a4421d073254421d0732066904421d073194421d073144421d0730f4421d0730a4421d073054421d07300c3",
			JHI: "4421d077394421d077344421d0772f4421d0772a4421d077254421d0772066904421d077194421d077144421d0770f4421d0770a4421d077054421d07700c3",
			JLS: "4421d076394421d076344421d0762f4421d0762a4421d076254421d0762066904421d076194421d076144421d0760f4421d0760a4421d076054421d07600c3",
			JNE: "4421d075394421d075344421d0752f4421d0752a4421d075254421d0752066904421d075194421d075144421d0750f4421d0750a4421d075054421d07500c3",
			JPC: "4421d07b394421d07b344421d07b2f4421d07b2a4421d07b254421d07b2066904421d07b194421d07b144421d07b0f4421d07b0a4421d07b054421d07b00c3"},
		"DECQ": map[asm.Instruction]string{
			JCS: "49ff0a723749ff0a723249ff0a722d49ff0a722849ff0a722349ff0a721e49ff0a721949ff0a721449ff0a720f49ff0a720a49ff0a720549ff0a7200c3",
			JGE: "49ff0a7d3949ff0a7d3449ff0a7d2f49ff0a7d2a49ff0a7d2549ff0a7d20669049ff0a7d1949ff0a7d1449ff0a7d0f49ff0a7d0a49ff0a7d0549ff0a7d00c3",
			JGT: "49ff0a7f3949ff0a7f3449ff0a7f2f49ff0a7f2a49ff0a7f2549ff0a7f20669049ff0a7f1949ff0a7f1449ff0a7f0f49ff0a7f0a49ff0a7f0549ff0a7f00c3",
			JHI: "49ff0a773749ff0a773249ff0a772d49ff0a772849ff0a772349ff0a771e49ff0a771949ff0a771449ff0a770f49ff0a770a49ff0a770549ff0a7700c3",
			JLE: "49ff0a7e3949ff0a7e3449ff0a7e2f49ff0a7e2a49ff0a7e2549ff0a7e20669049ff0a7e1949ff0a7e1449ff0a7e0f49ff0a7e0a49ff0a7e0549ff0a7e00c3",
			JLT: "49ff0a7c3949ff0a7c3449ff0a7c2f49ff0a7c2a49ff0a7c2549ff0a7c20669049ff0a7c1949ff0a7c1449ff0a7c0f49ff0a7c0a49ff0a7c0549ff0a7c00c3",
			JMI: "49ff0a783749ff0a783249ff0a782d49ff0a782849ff0a782349ff0a781e49ff0a781949ff0a781449ff0a780f49ff0a780a49ff0a780549ff0a7800c3",
			JCC: "49ff0a733749ff0a733249ff0a732d49ff0a732849ff0a732349ff0a731e49ff0a731949ff0a731449ff0a730f49ff0a730a49ff0a730549ff0a7300c3",
			JPC: "49ff0a7b3749ff0a7b3249ff0a7b2d49ff0a7b2849ff0a7b2349ff0a7b1e49ff0a7b1949ff0a7b1449ff0a7b0f49ff0a7b0a49ff0a7b0549ff0a7b00c3",
			JNE: "49ff0a753949ff0a753449ff0a752f49ff0a752a49ff0a752549ff0a7520669049ff0a751949ff0a751449ff0a750f49ff0a750a49ff0a750549ff0a7500c3",
			JLS: "49ff0a763749ff0a763249ff0a762d49ff0a762849ff0a762349ff0a761e49ff0a761949ff0a761449ff0a760f49ff0a760a49ff0a760549ff0a7600c3",
			JPS: "49ff0a7a3749ff0a7a3249ff0a7a2d49ff0a7a2849ff0a7a2349ff0a7a1e49ff0a7a1949ff0a7a1449ff0a7a0f49ff0a7a0a49ff0a7a0549ff0a7a00c3",
			JEQ: "49ff0a743949ff0a743449ff0a742f49ff0a742a49ff0a742549ff0a7420669049ff0a741949ff0a741449ff0a740f49ff0a740a49ff0a740549ff0a7400c3"},
		"TESTQ": map[asm.Instruction]string{
			JLT: "4885c07c394885c07c344885c07c2f4885c07c2a4885c07c254885c07c2066904885c07c194885c07c144885c07c0f4885c07c0a4885c07c054885c07c00c3",
			JEQ: "4885c074394885c074344885c0742f4885c0742a4885c074254885c0742066904885c074194885c074144885c0740f4885c0740a4885c074054885c07400c3",
			JGT: "4885c07f394885c07f344885c07f2f4885c07f2a4885c07f254885c07f2066904885c07f194885c07f144885c07f0f4885c07f0a4885c07f054885c07f00c3",
			JHI: "4885c077394885c077344885c0772f4885c0772a4885c077254885c0772066904885c077194885c077144885c0770f4885c0770a4885c077054885c07700c3",
			JLE: "4885c07e394885c07e344885c07e2f4885c07e2a4885c07e254885c07e2066904885c07e194885c07e144885c07e0f4885c07e0a4885c07e054885c07e00c3",
			JMI: "4885c078394885c078344885c0782f4885c0782a4885c078254885c0782066904885c078194885c078144885c0780f4885c0780a4885c078054885c07800c3",
			JNE: "4885c075394885c075344885c0752f4885c0752a4885c075254885c0752066904885c075194885c075144885c0750f4885c0750a4885c075054885c07500c3",
			JPC: "4885c07b394885c07b344885c07b2f4885c07b2a4885c07b254885c07b2066904885c07b194885c07b144885c07b0f4885c07b0a4885c07b054885c07b00c3",
			JPS: "4885c07a394885c07a344885c07a2f4885c07a2a4885c07a254885c07a2066904885c07a194885c07a144885c07a0f4885c07a0a4885c07a054885c07a00c3",
			JCC: "4885c073394885c073344885c0732f4885c0732a4885c073254885c0732066904885c073194885c073144885c0730f4885c0730a4885c073054885c07300c3",
			JCS: "4885c072394885c072344885c0722f4885c0722a4885c072254885c0722066904885c072194885c072144885c0720f4885c0720a4885c072054885c07200c3",
			JGE: "4885c07d394885c07d344885c07d2f4885c07d2a4885c07d254885c07d2066904885c07d194885c07d144885c07d0f4885c07d0a4885c07d054885c07d00c3",
			JLS: "4885c076394885c076344885c0762f4885c0762a4885c076254885c0762066904885c076194885c076144885c0760f4885c0760a4885c076054885c07600c3"},
		"ADDL(memory to register)": map[asm.Instruction]string{
			JLE: "410382d20400007e72410382d20400007e69410382d20400007e600f1f440000410382d20400007e52410382d20400007e49410382d20400007e400f1f440000410382d20400007e32410382d20400007e29410382d20400007e200f1f440000410382d20400007e12410382d20400007e09410382d20400007e00c3",
			JNE: "410382d20400007572410382d20400007569410382d204000075600f1f440000410382d20400007552410382d20400007549410382d204000075400f1f440000410382d20400007532410382d20400007529410382d204000075200f1f440000410382d20400007512410382d20400007509410382d20400007500c3",
			JPS: "410382d20400007a63410382d20400007a5a410382d20400007a51410382d20400007a48410382d20400007a3f410382d20400007a36410382d20400007a2d410382d20400007a24410382d20400007a1b410382d20400007a12410382d20400007a09410382d20400007a00c3",
			JEQ: "410382d20400007472410382d20400007469410382d204000074600f1f440000410382d20400007452410382d20400007449410382d204000074400f1f440000410382d20400007432410382d20400007429410382d204000074200f1f440000410382d20400007412410382d20400007409410382d20400007400c3",
			JCS: "410382d20400007272410382d20400007269410382d204000072600f1f440000410382d20400007252410382d20400007249410382d204000072400f1f440000410382d20400007232410382d20400007229410382d204000072200f1f440000410382d20400007212410382d20400007209410382d20400007200c3",
			JGE: "410382d20400007d72410382d20400007d69410382d20400007d600f1f440000410382d20400007d52410382d20400007d49410382d20400007d400f1f440000410382d20400007d32410382d20400007d29410382d20400007d200f1f440000410382d20400007d12410382d20400007d09410382d20400007d00c3",
			JGT: "410382d20400007f72410382d20400007f69410382d20400007f600f1f440000410382d20400007f52410382d20400007f49410382d20400007f400f1f440000410382d20400007f32410382d20400007f29410382d20400007f200f1f440000410382d20400007f12410382d20400007f09410382d20400007f00c3",
			JHI: "410382d20400007772410382d20400007769410382d204000077600f1f440000410382d20400007752410382d20400007749410382d204000077400f1f440000410382d20400007732410382d20400007729410382d204000077200f1f440000410382d20400007712410382d20400007709410382d20400007700c3",
			JLS: "410382d20400007672410382d20400007669410382d204000076600f1f440000410382d20400007652410382d20400007649410382d204000076400f1f440000410382d20400007632410382d20400007629410382d204000076200f1f440000410382d20400007612410382d20400007609410382d20400007600c3",
			JLT: "410382d20400007c72410382d20400007c69410382d20400007c600f1f440000410382d20400007c52410382d20400007c49410382d20400007c400f1f440000410382d20400007c32410382d20400007c29410382d20400007c200f1f440000410382d20400007c12410382d20400007c09410382d20400007c00c3",
			JMI: "410382d20400007863410382d2040000785a410382d20400007851410382d20400007848410382d2040000783f410382d20400007836410382d2040000782d410382d20400007824410382d2040000781b410382d20400007812410382d20400007809410382d20400007800c3",
			JCC: "410382d20400007372410382d20400007369410382d204000073600f1f440000410382d20400007352410382d20400007349410382d204000073400f1f440000410382d20400007332410382d20400007329410382d204000073200f1f440000410382d20400007312410382d20400007309410382d20400007300c3",
			JPC: "410382d20400007b63410382d20400007b5a410382d20400007b51410382d20400007b48410382d20400007b3f410382d20400007b36410382d20400007b2d410382d20400007b24410382d20400007b1b410382d20400007b12410382d20400007b09410382d20400007b00c3"},
		"ADDQ (register to register)": map[asm.Instruction]string{
			JMI: "4c01d078374c01d078324c01d0782d4c01d078284c01d078234c01d0781e4c01d078194c01d078144c01d0780f4c01d0780a4c01d078054c01d07800c3",
			JNE: "4c01d075394c01d075344c01d0752f4c01d0752a4c01d075254c01d0752066904c01d075194c01d075144c01d0750f4c01d0750a4c01d075054c01d07500c3",
			JCC: "4c01d073394c01d073344c01d0732f4c01d0732a4c01d073254c01d0732066904c01d073194c01d073144c01d0730f4c01d0730a4c01d073054c01d07300c3",
			JCS: "4c01d072394c01d072344c01d0722f4c01d0722a4c01d072254c01d0722066904c01d072194c01d072144c01d0720f4c01d0720a4c01d072054c01d07200c3",
			JGE: "4c01d07d394c01d07d344c01d07d2f4c01d07d2a4c01d07d254c01d07d2066904c01d07d194c01d07d144c01d07d0f4c01d07d0a4c01d07d054c01d07d00c3",
			JGT: "4c01d07f394c01d07f344c01d07f2f4c01d07f2a4c01d07f254c01d07f2066904c01d07f194c01d07f144c01d07f0f4c01d07f0a4c01d07f054c01d07f00c3",
			JLS: "4c01d076394c01d076344c01d0762f4c01d0762a4c01d076254c01d0762066904c01d076194c01d076144c01d0760f4c01d0760a4c01d076054c01d07600c3",
			JLT: "4c01d07c394c01d07c344c01d07c2f4c01d07c2a4c01d07c254c01d07c2066904c01d07c194c01d07c144c01d07c0f4c01d07c0a4c01d07c054c01d07c00c3",
			JPC: "4c01d07b374c01d07b324c01d07b2d4c01d07b284c01d07b234c01d07b1e4c01d07b194c01d07b144c01d07b0f4c01d07b0a4c01d07b054c01d07b00c3",
			JEQ: "4c01d074394c01d074344c01d0742f4c01d0742a4c01d074254c01d0742066904c01d074194c01d074144c01d0740f4c01d0740a4c01d074054c01d07400c3",
			JHI: "4c01d077394c01d077344c01d0772f4c01d0772a4c01d077254c01d0772066904c01d077194c01d077144c01d0770f4c01d0770a4c01d077054c01d07700c3",
			JLE: "4c01d07e394c01d07e344c01d07e2f4c01d07e2a4c01d07e254c01d07e2066904c01d07e194c01d07e144c01d07e0f4c01d07e0a4c01d07e054c01d07e00c3",
			JPS: "4c01d07a374c01d07a324c01d07a2d4c01d07a284c01d07a234c01d07a1e4c01d07a194c01d07a144c01d07a0f4c01d07a0a4c01d07a054c01d07a00c3"},
		"ADDQ(const to register)": map[asm.Instruction]string{
			JLT: "4981c2d20400007c724981c2d20400007c694981c2d20400007c600f1f4400004981c2d20400007c524981c2d20400007c494981c2d20400007c400f1f4400004981c2d20400007c324981c2d20400007c294981c2d20400007c200f1f4400004981c2d20400007c124981c2d20400007c094981c2d20400007c00c3",
			JMI: "4981c2d204000078634981c2d2040000785a4981c2d204000078514981c2d204000078484981c2d2040000783f4981c2d204000078364981c2d2040000782d4981c2d204000078244981c2d2040000781b4981c2d204000078124981c2d204000078094981c2d20400007800c3",
			JNE: "4981c2d204000075724981c2d204000075694981c2d204000075600f1f4400004981c2d204000075524981c2d204000075494981c2d204000075400f1f4400004981c2d204000075324981c2d204000075294981c2d204000075200f1f4400004981c2d204000075124981c2d204000075094981c2d20400007500c3",
			JPS: "4981c2d20400007a634981c2d20400007a5a4981c2d20400007a514981c2d20400007a484981c2d20400007a3f4981c2d20400007a364981c2d20400007a2d4981c2d20400007a244981c2d20400007a1b4981c2d20400007a124981c2d20400007a094981c2d20400007a00c3",
			JGE: "4981c2d20400007d724981c2d20400007d694981c2d20400007d600f1f4400004981c2d20400007d524981c2d20400007d494981c2d20400007d400f1f4400004981c2d20400007d324981c2d20400007d294981c2d20400007d200f1f4400004981c2d20400007d124981c2d20400007d094981c2d20400007d00c3",
			JHI: "4981c2d204000077724981c2d204000077694981c2d204000077600f1f4400004981c2d204000077524981c2d204000077494981c2d204000077400f1f4400004981c2d204000077324981c2d204000077294981c2d204000077200f1f4400004981c2d204000077124981c2d204000077094981c2d20400007700c3",
			JLS: "4981c2d204000076724981c2d204000076694981c2d204000076600f1f4400004981c2d204000076524981c2d204000076494981c2d204000076400f1f4400004981c2d204000076324981c2d204000076294981c2d204000076200f1f4400004981c2d204000076124981c2d204000076094981c2d20400007600c3",
			JGT: "4981c2d20400007f724981c2d20400007f694981c2d20400007f600f1f4400004981c2d20400007f524981c2d20400007f494981c2d20400007f400f1f4400004981c2d20400007f324981c2d20400007f294981c2d20400007f200f1f4400004981c2d20400007f124981c2d20400007f094981c2d20400007f00c3",
			JLE: "4981c2d20400007e724981c2d20400007e694981c2d20400007e600f1f4400004981c2d20400007e524981c2d20400007e494981c2d20400007e400f1f4400004981c2d20400007e324981c2d20400007e294981c2d20400007e200f1f4400004981c2d20400007e124981c2d20400007e094981c2d20400007e00c3",
			JPC: "4981c2d20400007b634981c2d20400007b5a4981c2d20400007b514981c2d20400007b484981c2d20400007b3f4981c2d20400007b364981c2d20400007b2d4981c2d20400007b244981c2d20400007b1b4981c2d20400007b124981c2d20400007b094981c2d20400007b00c3",
			JCC: "4981c2d204000073724981c2d204000073694981c2d204000073600f1f4400004981c2d204000073524981c2d204000073494981c2d204000073400f1f4400004981c2d204000073324981c2d204000073294981c2d204000073200f1f4400004981c2d204000073124981c2d204000073094981c2d20400007300c3",
			JCS: "4981c2d204000072724981c2d204000072694981c2d204000072600f1f4400004981c2d204000072524981c2d204000072494981c2d204000072400f1f4400004981c2d204000072324981c2d204000072294981c2d204000072200f1f4400004981c2d204000072124981c2d204000072094981c2d20400007200c3",
			JEQ: "4981c2d204000074724981c2d204000074694981c2d204000074600f1f4400004981c2d204000074524981c2d204000074494981c2d204000074400f1f4400004981c2d204000074324981c2d204000074294981c2d204000074200f1f4400004981c2d204000074124981c2d204000074094981c2d20400007400c3"},
		"SUBQ (register to register)": map[asm.Instruction]string{
			JCS: "4c29d072394c29d072344c29d0722f4c29d0722a4c29d072254c29d0722066904c29d072194c29d072144c29d0720f4c29d0720a4c29d072054c29d07200c3",
			JEQ: "4c29d074394c29d074344c29d0742f4c29d0742a4c29d074254c29d0742066904c29d074194c29d074144c29d0740f4c29d0740a4c29d074054c29d07400c3",
			JHI: "4c29d077394c29d077344c29d0772f4c29d0772a4c29d077254c29d0772066904c29d077194c29d077144c29d0770f4c29d0770a4c29d077054c29d07700c3",
			JLS: "4c29d076394c29d076344c29d0762f4c29d0762a4c29d076254c29d0762066904c29d076194c29d076144c29d0760f4c29d0760a4c29d076054c29d07600c3",
			JLT: "4c29d07c394c29d07c344c29d07c2f4c29d07c2a4c29d07c254c29d07c2066904c29d07c194c29d07c144c29d07c0f4c29d07c0a4c29d07c054c29d07c00c3",
			JNE: "4c29d075394c29d075344c29d0752f4c29d0752a4c29d075254c29d0752066904c29d075194c29d075144c29d0750f4c29d0750a4c29d075054c29d07500c3",
			JPC: "4c29d07b374c29d07b324c29d07b2d4c29d07b284c29d07b234c29d07b1e4c29d07b194c29d07b144c29d07b0f4c29d07b0a4c29d07b054c29d07b00c3",
			JCC: "4c29d073394c29d073344c29d0732f4c29d0732a4c29d073254c29d0732066904c29d073194c29d073144c29d0730f4c29d0730a4c29d073054c29d07300c3",
			JGT: "4c29d07f394c29d07f344c29d07f2f4c29d07f2a4c29d07f254c29d07f2066904c29d07f194c29d07f144c29d07f0f4c29d07f0a4c29d07f054c29d07f00c3",
			JLE: "4c29d07e394c29d07e344c29d07e2f4c29d07e2a4c29d07e254c29d07e2066904c29d07e194c29d07e144c29d07e0f4c29d07e0a4c29d07e054c29d07e00c3",
			JMI: "4c29d078374c29d078324c29d0782d4c29d078284c29d078234c29d0781e4c29d078194c29d078144c29d0780f4c29d0780a4c29d078054c29d07800c3",
			JPS: "4c29d07a374c29d07a324c29d07a2d4c29d07a284c29d07a234c29d07a1e4c29d07a194c29d07a144c29d07a0f4c29d07a0a4c29d07a054c29d07a00c3",
			JGE: "4c29d07d394c29d07d344c29d07d2f4c29d07d2a4c29d07d254c29d07d2066904c29d07d194c29d07d144c29d07d0f4c29d07d0a4c29d07d054c29d07d00c3"},
		"CMPL(memory to const)": map[asm.Instruction]string{
			JEQ: "8378010a74428378010a743c8378010a74368378010a74308378010a742a8378010a74248378010a741e8378010a74188378010a74128378010a740c8378010a74068378010a7400c3",
			JGE: "8378010a7d428378010a7d3c8378010a7d368378010a7d308378010a7d2a8378010a7d248378010a7d1e8378010a7d188378010a7d128378010a7d0c8378010a7d068378010a7d00c3",
			JGT: "8378010a7f428378010a7f3c8378010a7f368378010a7f308378010a7f2a8378010a7f248378010a7f1e8378010a7f188378010a7f128378010a7f0c8378010a7f068378010a7f00c3",
			JHI: "8378010a77428378010a773c8378010a77368378010a77308378010a772a8378010a77248378010a771e8378010a77188378010a77128378010a770c8378010a77068378010a7700c3",
			JMI: "8378010a78428378010a783c8378010a78368378010a78308378010a782a8378010a78248378010a781e8378010a78188378010a78128378010a780c8378010a78068378010a7800c3",
			JPS: "8378010a7a428378010a7a3c8378010a7a368378010a7a308378010a7a2a8378010a7a248378010a7a1e8378010a7a188378010a7a128378010a7a0c8378010a7a068378010a7a00c3",
			JCC: "8378010a73428378010a733c8378010a73368378010a73308378010a732a8378010a73248378010a731e8378010a73188378010a73128378010a730c8378010a73068378010a7300c3",
			JCS: "8378010a72428378010a723c8378010a72368378010a72308378010a722a8378010a72248378010a721e8378010a72188378010a72128378010a720c8378010a72068378010a7200c3",
			JLE: "8378010a7e428378010a7e3c8378010a7e368378010a7e308378010a7e2a8378010a7e248378010a7e1e8378010a7e188378010a7e128378010a7e0c8378010a7e068378010a7e00c3",
			JLS: "8378010a76428378010a763c8378010a76368378010a76308378010a762a8378010a76248378010a761e8378010a76188378010a76128378010a760c8378010a76068378010a7600c3",
			JLT: "8378010a7c428378010a7c3c8378010a7c368378010a7c308378010a7c2a8378010a7c248378010a7c1e8378010a7c188378010a7c128378010a7c0c8378010a7c068378010a7c00c3",
			JNE: "8378010a75428378010a753c8378010a75368378010a75308378010a752a8378010a75248378010a751e8378010a75188378010a75128378010a750c8378010a75068378010a7500c3",
			JPC: "8378010a7b428378010a7b3c8378010a7b368378010a7b308378010a7b2a8378010a7b248378010a7b1e8378010a7b188378010a7b128378010a7b0c8378010a7b068378010a7b00c3"},
		"TESTL": map[asm.Instruction]string{
			JCS: "85c0723085c0722c85c0722885c0722485c0722085c0721c85c072180f1f400085c0721085c0720c85c0720885c0720485c07200c3",
			JGE: "85c07d3085c07d2c85c07d2885c07d2485c07d2085c07d1c85c07d180f1f400085c07d1085c07d0c85c07d0885c07d0485c07d00c3",
			JGT: "85c07f3085c07f2c85c07f2885c07f2485c07f2085c07f1c85c07f180f1f400085c07f1085c07f0c85c07f0885c07f0485c07f00c3",
			JLT: "85c07c3085c07c2c85c07c2885c07c2485c07c2085c07c1c85c07c180f1f400085c07c1085c07c0c85c07c0885c07c0485c07c00c3",
			JMI: "85c0783085c0782c85c0782885c0782485c0782085c0781c85c078180f1f400085c0781085c0780c85c0780885c0780485c07800c3",
			JPC: "85c07b3085c07b2c85c07b2885c07b2485c07b2085c07b1c85c07b180f1f400085c07b1085c07b0c85c07b0885c07b0485c07b00c3",
			JPS: "85c07a3085c07a2c85c07a2885c07a2485c07a2085c07a1c85c07a180f1f400085c07a1085c07a0c85c07a0885c07a0485c07a00c3",
			JCC: "85c0733085c0732c85c0732885c0732485c0732085c0731c85c073180f1f400085c0731085c0730c85c0730885c0730485c07300c3",
			JEQ: "85c0743085c0742c85c0742885c0742485c0742085c0741c85c074180f1f400085c0741085c0740c85c0740885c0740485c07400c3",
			JHI: "85c0773085c0772c85c0772885c0772485c0772085c0771c85c077180f1f400085c0771085c0770c85c0770885c0770485c07700c3",
			JLE: "85c07e3085c07e2c85c07e2885c07e2485c07e2085c07e1c85c07e180f1f400085c07e1085c07e0c85c07e0885c07e0485c07e00c3",
			JLS: "85c0763085c0762c85c0762885c0762485c0762085c0761c85c076180f1f400085c0761085c0760c85c0760885c0760485c07600c3",
			JNE: "85c0753085c0752c85c0752885c0752485c0752085c0751c85c075180f1f400085c0751085c0750c85c0750885c0750485c07500c3"},
	}

	for _, tt := range tests {
		tc := tt
		t.Run(tc.name, func(t *testing.T) {
			exps := nameToInstToExpectedHexString[tc.name]
			for _, jmpInst := range []asm.Instruction{JCC, JCS, JEQ, JGE, JGT, JHI, JLE, JLS, JLT, JMI, JNE, JPC, JPS} {
				t.Run(InstructionName(jmpInst), func(t *testing.T) {
					a := NewAssemblerImpl()

					var jmps []asm.Node
					for i := 0; i < 12; i++ { // Large enough so that this includes long jump.
						tc.setupFn(a)
						jmps = append(jmps, a.CompileJump(jmpInst))
					}

					target := a.CompileStandAlone(RET)
					for _, jmp := range jmps {
						jmp.AssignJumpTarget(target)
					}

					actual, err := a.Assemble()
					require.NoError(t, err)

					require.Equal(t, exps[jmpInst], hex.EncodeToString(actual))
				})
			}
		})
	}
}
